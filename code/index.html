<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="initial-scale=1.0"><title>Chris Gaeta - Side Projects</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" href="../css/all.css"><script type="text/javascript" src="../js/scripts.js"></script><link rel="stylesheet" href="../css/portfolio.css"></head><body><div class="fs-12" id="wrapper"><div id="navBack"></div><img id="hero" src="../img/portrait_short_pre.png"><div id="navCont"><nav class="fs-12" id="navigation"><a class="navlink fs-4 fs-3-800 fs-4-640 fs-5-480 fo-1 fo-640" href="../"><h1 class="name">Chris Gaeta</h1></a><a class="navlink fs-1 fs-2-1280 fo-3 fo-1-1280" href="../about">About</a><a class="navlink fs-1 fs-2-1280 fo" href="../resume">Resume</a></nav></div><div class="body"><div class="section fs-8"><div class="projects"><div class="projectdesc"><h2 class="projectName">My Portfolio</h2><ul class="technology"><li>Templating Engine</li><li>Task Runner</li><li>Parallax Backgrounds</li></ul><ul class="tools"><li>Node.js</li><li>Gulp</li><li>SASS</li><li>Pug (formerly - Jade)</li></ul><p class="projectText">I built my portfolio using Node.js and several other development tool to refine my development pipeline.</p><a class="seeMore btn" href="./tatree/" target="_blank">Try it</a><!--a.bitbucketRepo.btn(href=p.repo target="_blank") See the repo--></div><div class="demoCont"><ul class="demoFiles"><li class="selected">layouts/nav.pug</li><li>layouts/layout.pug</li><li>mixins/mixinProject.pug</li><li>pages/index.pug</li><li>pages/code.pug</li></ul><pre><code class="demo"><span class="lineNum">1</span>#navBack
<span class="lineNum">2</span>img#hero(src=(url === "/" ? "img/portrait_pre.png" : url === "/code/" ? "../img/portrait_short_pre.png" : "img/portrait_short_pre.png"))
<span class="lineNum">3</span>#navCont(style=(url==="/"?"padding:12.5% 0 37.5%":""))
<span class="lineNum">4</span>  include /templates/mixins/mixinNav.pug
<span class="lineNum">5</span>  -
<span class="lineNum">6</span>    var links = [
<span class="lineNum">7</span>      {
<span class="lineNum">8</span>        name: "&lt;h1 class=\"name\"&gt;Chris Gaeta&lt;/h1&gt;",
<span class="lineNum">9</span>        url: "\/",
<span class="lineNum">10</span>        classes: "fs-4 fs-3-800 fs-4-640 fs-5-480 fo-1 fo-640"
<span class="lineNum">11</span>      },
<span class="lineNum">12</span>      {
<span class="lineNum">13</span>        name: "About",
<span class="lineNum">14</span>        url: "\/about",
<span class="lineNum">15</span>        classes: "fs-1 fs-2-1280 fo-3 fo-1-1280"
<span class="lineNum">16</span>      },
<span class="lineNum">17</span>      {
<span class="lineNum">18</span>        name: "Resume",
<span class="lineNum">19</span>        url: "/resume"
<span class="lineNum">20</span>      }/*,
<span class="lineNum">21</span>      {
<span class="lineNum">22</span>        name: "Code",
<span class="lineNum">23</span>        url: "/code/"
<span class="lineNum">24</span>      }*/
<span class="lineNum">25</span>    ];
<span class="lineNum">26</span>    var sel = -1;
<span class="lineNum">27</span>    switch(url) {
<span class="lineNum">28</span>      case "/": sel = 0;
<span class="lineNum">29</span>        break;
<span class="lineNum">30</span>      case "/about": sel = 1;
<span class="lineNum">31</span>        break;
<span class="lineNum">32</span>      case "/resume": sel = 2;
<span class="lineNum">33</span>        break;
<span class="lineNum">34</span>      case "/code/": sel = 3;
<span class="lineNum">35</span>        break;
<span class="lineNum">36</span>    }
<span class="lineNum">37</span>  +nav(links, sel, "fs-12", dir)(class="fs-1 fs-2-1280 fo")
<span class="lineNum">38</span>  if url === "/"
<span class="lineNum">39</span>    #intro.fs-10.fo-1
<span class="lineNum">40</span>      p.introtext
<span class="lineNum">41</span>        span Hey
<span class="lineNum">42</span>        | I&amp;apos;m a UX researcher, designer, and developer.
<span class="lineNum">43</span>      p.introaside And then I dance and play video games.
<span class="lineNum">44</span></code><code class="demo"><span class="lineNum">1</span>doctype html
<span class="lineNum">2</span>html
<span class="lineNum">3</span>  head
<span class="lineNum">4</span>    block locals
<span class="lineNum">5</span>      -
<span class="lineNum">6</span>        var title = "Chris Gaeta";
<span class="lineNum">7</span>        var dir =   ".";
<span class="lineNum">8</span>        var url =   "./";
<span class="lineNum">9</span>        var par_flag = false;
<span class="lineNum">10</span>    block links
<span class="lineNum">11</span>      include /templates/layouts/head.pug
<span class="lineNum">12</span>  body
<span class="lineNum">13</span>    #wrapper.fs-12(class={ parallax: par_flag })
<span class="lineNum">14</span>      include /templates/layouts/nav.pug
<span class="lineNum">15</span>      block content
<span class="lineNum">16</span>        .body
<span class="lineNum">17</span>          block body
<span class="lineNum">18</span>      block footer
<span class="lineNum">19</span>        include /templates/layouts/footer.pug
<span class="lineNum">20</span></code><code class="demo"><span class="lineNum">1</span>mixin project(p)
<span class="lineNum">2</span>  .projects
<span class="lineNum">3</span>    if p.imgs.length &gt; 0
<span class="lineNum">4</span>      .projectImages
<span class="lineNum">5</span>        each val in p.imgs
<span class="lineNum">6</span>          img.projectImg(src=dir+"/img/"+val+".png")
<span class="lineNum">7</span>    .projectdesc
<span class="lineNum">8</span>      h2.projectName #{p.name}
<span class="lineNum">9</span>      ul.technology
<span class="lineNum">10</span>        each val in p.tech
<span class="lineNum">11</span>          li= val
<span class="lineNum">12</span>      ul.tools
<span class="lineNum">13</span>        each val in p.tools
<span class="lineNum">14</span>          li= val
<span class="lineNum">15</span>      each val in p.text
<span class="lineNum">16</span>        p.projectText= val
<span class="lineNum">17</span>      a.seeMore.btn(href=p.seeMore target="_blank") Try it
<span class="lineNum">18</span>      //a.bitbucketRepo.btn(href=p.repo target="_blank") See the repo
<span class="lineNum">19</span>    if block
<span class="lineNum">20</span>      .demoCont
<span class="lineNum">21</span>        ul.demoFiles
<span class="lineNum">22</span>          each val, ind in p.list
<span class="lineNum">23</span>            if ind === 0
<span class="lineNum">24</span>              li.selected= val
<span class="lineNum">25</span>            else
<span class="lineNum">26</span>              li= val
<span class="lineNum">27</span>        pre
<span class="lineNum">28</span>          block
<span class="lineNum">29</span></code><code class="demo"><span class="lineNum">1</span>extends /templates/layouts/layout.pug
<span class="lineNum">2</span>block locals
<span class="lineNum">3</span>  -
<span class="lineNum">4</span>    var title = "Chris Gaeta"
<span class="lineNum">5</span>    var dir =   "."
<span class="lineNum">6</span>    var url =   "/"
<span class="lineNum">7</span>    var par_flag = true;
<span class="lineNum">8</span>append links
<span class="lineNum">9</span>  link(rel="stylesheet" href=dir+"/css/portfolio.css")
<span class="lineNum">10</span>  link(rel="stylesheet" href=dir+"/css/projectStyles.css")
<span class="lineNum">11</span>block content
<span class="lineNum">12</span>  #dia2.projects.parallax_group
<span class="lineNum">13</span>    .par_layer.back
<span class="lineNum">14</span>    .fs-10.fo-1.fs-12-1280.fo-0-1280.par_layer.base
<span class="lineNum">15</span>      .projectdesc
<span class="lineNum">16</span>        a(href="http://dia2.org")
<span class="lineNum">17</span>          h2.projectName DIA2
<span class="lineNum">18</span>        p.projectText DIA2 is a data-mining tool for academics created to explore National Science Foundation grants.
<span class="lineNum">19</span>        p.projectText.fs-hide-640 I collaborated with the UX team in designing interactions, developing interactive prototypes, and implementing changes to the data visualization tool.
<span class="lineNum">20</span>    ul#design_stories.fs-10.fo-1.fs-12-1280.fo-0-1280
<span class="lineNum">21</span>      li.story.par_layer.base
<span class="lineNum">22</span>        h3.story_title Responsive Design
<span class="lineNum">23</span>        img.banner(src="img/responsive_page_pre.png")
<span class="lineNum">24</span>      li.story.par_layer.base
<span class="lineNum">25</span>        h3.story_title Collaborative Revisions
<span class="lineNum">26</span>        svg.banner(width="1300px" height="700px")
<span class="lineNum">27</span>          defs
<span class="lineNum">28</span>            mask#mask(maskUnits="userSpaceOnUse" maskContentUnits="userSpaceOnUse")
<span class="lineNum">29</span>              linearGradient#gradient(gradientUnits="objectBoundingBox" x2="1" y2="0")
<span class="lineNum">30</span>                stop#stop1(stop-color="#ffffff" stop-opacity="1" offset="0")
<span class="lineNum">31</span>                stop#stop2(stop-color="#ffffff" stop-opacity="0" offset="5%")
<span class="lineNum">32</span>              rect(width="100%" height="100%" fill="url(#gradient)")
<span class="lineNum">33</span>          image#backImg(xlink:href="img/DIA2_old_interface_pre.png" width="100%")
<span class="lineNum">34</span>          image#frontImg(xlink:href="img/DIA2_comp_pre.png" mask="url(#mask)" width="100%")
<span class="lineNum">35</span>      li.story.par_layer.base
<span class="lineNum">36</span>        h3.story_title Interaction Design
<span class="lineNum">37</span>        #ixd.fs-5.fs-10-800.fo-1.inlineBlock.imgCont
<span class="lineNum">38</span>          img(src='img/DIA2_login_flow_480_pre.png')
<span class="lineNum">39</span>          img(src='img/DIA2_login_wireframe_480_pre.png')
<span class="lineNum">40</span>          img.banner(src='img/DIA2_launch_guide_pre.png')
<span class="lineNum">41</span>  #vstar.projects.parallax_group
<span class="lineNum">42</span>    .par_layer.back
<span class="lineNum">43</span>    .fs-10.fo-1.fs-12-1280.fo-0-1280.par_layer.base
<span class="lineNum">44</span>      .projectdesc
<span class="lineNum">45</span>        h2.projectName VSTAR
<span class="lineNum">46</span>        p.projectText VSTAR is an online student transition program for incoming Purdue students. The program&amp;apos;s primary target demographics was international students, especially Chinese students.
<span class="lineNum">47</span>        p.projectText.fs-hide-640 I collaborated with a team of UX design and Civil Engineering students to conduct user research, usability studies, and redesigning the orientation tools and process.
<span class="lineNum">48</span>    ul#design_process.flex.par_layer.base
<span class="lineNum">49</span>      li.design_story.fs-5.fs-12-800.fo-0-800
<span class="lineNum">50</span>        h3.story_title Heuristic Analysis
<span class="lineNum">51</span>        img.design_img(src='img/vstar_heuristics_240_pre.png' alt='Heuristic analysis' title='Heuristic analysis', data='vstar_eval')
<span class="lineNum">52</span>        .design_text
<span class="lineNum">53</span>          p We started with a Heuristic Evaluation of the current orientation process and decided to redesign VSTAR from scratch.
<span class="lineNum">54</span>      li.design_story.fs-5.fs-12-800.fo-2.fo-0-800
<span class="lineNum">55</span>        h3.story_title Data Collection
<span class="lineNum">56</span>        img.design_img(src='img/meeting_photo_pre.jpg' alt='Data Collection' title="Data Collection")
<span class="lineNum">57</span>        .design_text
<span class="lineNum">58</span>          p We conducted three interviews - one with an academic advisor, two with students - and used an open-ended survey to learn about our users and their needs.
<span class="lineNum">59</span>      li.design_story.fs-5.fs-12-800.fo-0-800
<span class="lineNum">60</span>        h3.story_title Analysis
<span class="lineNum">61</span>        img.design_img(src='img/vstar_persona_pre.png' alt='User research' title='User research')
<span class="lineNum">62</span>        .design_text
<span class="lineNum">63</span>          p From our notes and surveys, we used an affinity diagram to develop a persona and identify design requirements.
<span class="lineNum">64</span>      li.design_story.fs-5.fs-12-800.fo-2.fo-0-800
<span class="lineNum">65</span>        h3.story_title Ideation
<span class="lineNum">66</span>        img.design_img(src='img/vstar_prototype_pre.png' alt='VSTAR prototype' title='VSTAR prototype')
<span class="lineNum">67</span>        .design_text
<span class="lineNum">68</span>          p We sketched several ideas and settled on a design for our first prototype.
<span class="lineNum">69</span>      li.design_story.fs-5.fs-12-800.fo-0-800
<span class="lineNum">70</span>        h3.story_title Usability Testing
<span class="lineNum">71</span>        img.design_img(src='img/vstar_usability2_240_pre.png' alt='VSTAR usability test' title='VSTAR usability test')
<span class="lineNum">72</span>        .design_text
<span class="lineNum">73</span>          p We created a set of paper prototypes and recruited five participants - three high school students, and two college students - to test the usability of our design.
<span class="lineNum">74</span>      li.design_story.fs-5.fs-12-800.fo-2.fo-0-800
<span class="lineNum">75</span>        h3.story_title Deliverables
<span class="lineNum">76</span>        img.design_img(src='img/vstar_research_pre.png' alt='VSTAR user research' title='VSTAR user research')
<span class="lineNum">77</span>        .design_text
<span class="lineNum">78</span>          p We presented our client with a report on our findings and our prototype.
<span class="lineNum">79</span>    .design_story.fs-6.fs-12-800.fo-3.fo-0-800.par_layer.base
<span class="lineNum">80</span>      h3.story_title Check it out
<span class="lineNum">81</span>      .design_text
<span class="lineNum">82</span>        p Below are some links to our reports and to our interactive prototype - feel free to look.
<span class="lineNum">83</span>        ul.vstar_links
<span class="lineNum">84</span>          li
<span class="lineNum">85</span>            a(href='https://www.dropbox.com/s/tqzt8wt8aej1zec/2-VSTAR_2_Heuristic_Evaluation.pdf?dl=0', target='_blank') Heuristic Evaluation Report
<span class="lineNum">86</span>          li
<span class="lineNum">87</span>            a(href='https://www.dropbox.com/s/bo4by9f6brw1hs6/3-VSTAR_User_Research_Report.pdf?dl=0', target='_blank') User Research Report
<span class="lineNum">88</span>          li
<span class="lineNum">89</span>            a(href='https://www.dropbox.com/s/jxnlquxmxarknqz/5-VSTAR_2_Design_Report.pdf?dl=0', target='_blank') Design Report
<span class="lineNum">90</span>          li
<span class="lineNum">91</span>            a(href='https://www.dropbox.com/s/y1vnw7ghr4pns3s/7-VSTAR_2_Usability_Report.pdf?dl=0', target='_blank') Usability Report
<span class="lineNum">92</span>          li
<span class="lineNum">93</span>            a(href='https://projects.invisionapp.com/share/2C1UH1RFV#/screens/52515714', target='_blank') Interactive InVisio Prototype
<span class="lineNum">94</span>  #thesis.projects.parallax_group
<span class="lineNum">95</span>    .par_layer.back
<span class="lineNum">96</span>    .fs-10.fo-1.fs-12-1280.fo-0-1280.par_layer.base
<span class="lineNum">97</span>      .projectdesc
<span class="lineNum">98</span>        h2.projectName Master&amp;apos;s Thesis: Quit Playing With Your Watch
<span class="lineNum">99</span>        p.abstract This study identified perceptions and social norms that may affect smartwatch adoption. Interviews were conducted to identify perceptions of smartwatch use and norms that might affect those perceptions.
<span class="lineNum">100</span>        p.abstract.fs-hide-640 Smartwatch use was found to activate norms associated with wristwatch use &amp;ndash; specifically, smartwatch users&amp;rsquo; peers took offense to the users looking at their wristwatches. This study also found that norms prevent the use of smartwatches&amp;rsquo; voice controls in public and various perceptions of smartwatch use and ownership.
<span class="lineNum">101</span>        a.seeMore(href='https://www.scribd.com/doc/312780812/Quit-Playing-With-Your-Watch-Perceptions-of-Smartwatch-Use', target='_blank') Read it
<span class="lineNum">102</span></code><code class="demo"><span class="lineNum">1</span>extends /templates/layouts/layout.pug
<span class="lineNum">2</span>block locals
<span class="lineNum">3</span>  -
<span class="lineNum">4</span>    var title = "Chris Gaeta - Side Projects";
<span class="lineNum">5</span>    var dir =   "..";
<span class="lineNum">6</span>    var url =   "/code/";
<span class="lineNum">7</span>append links
<span class="lineNum">8</span>  link(rel="stylesheet" href=dir+"/css/portfolio.css")
<span class="lineNum">9</span>block body
<span class="lineNum">10</span>  .section.fs-8
<span class="lineNum">11</span>    include /templates/mixins/mixinProject.pug
<span class="lineNum">12</span>    -
<span class="lineNum">13</span>      var pr = {
<span class="lineNum">14</span>        imgs: [],
<span class="lineNum">15</span>        name: "My Portfolio",
<span class="lineNum">16</span>        tech: ["Templating Engine", "Task Runner", "Parallax Backgrounds"],
<span class="lineNum">17</span>        tools: ["Node.js", "Gulp", "SASS", "Pug (formerly - Jade)"],
<span class="lineNum">18</span>        text: [
<span class="lineNum">19</span>          "I built my portfolio using Node.js and several other development tool to refine my development pipeline."
<span class="lineNum">20</span>        ],
<span class="lineNum">21</span>        list: ['layouts/nav.pug', 'layouts/layout.pug', 'mixins/mixinProject.pug', 'pages/index.pug', 'pages/code.pug'],
<span class="lineNum">22</span>        seeMore: "./tatree/",
<span class="lineNum">23</span>        repo: "https://bitbucket.org/chrismgaeta/tatree"
<span class="lineNum">24</span>      };
<span class="lineNum">25</span>    +project(pr)
<span class="lineNum">26</span>      code.demo
<span class="lineNum">27</span>        include:escape() /templates/layouts/nav.pug
<span class="lineNum">28</span>      code.demo
<span class="lineNum">29</span>        include:escape() /templates/layouts/layout.pug
<span class="lineNum">30</span>      code.demo
<span class="lineNum">31</span>        include:escape() /templates/mixins/mixinProject.pug
<span class="lineNum">32</span>      code.demo
<span class="lineNum">33</span>        include:escape() /templates/pages/index.pug
<span class="lineNum">34</span>      code.demo
<span class="lineNum">35</span>        include:escape() /templates/pages/code.pug
<span class="lineNum">36</span>    -
<span class="lineNum">37</span>      var pr = {
<span class="lineNum">38</span>        imgs: [],
<span class="lineNum">39</span>        name: "TATree",
<span class="lineNum">40</span>        tech: ["Data vis"],
<span class="lineNum">41</span>        tools: ["D3"],
<span class="lineNum">42</span>        text: [
<span class="lineNum">43</span>          "TATree is a data visualization tool I created for myself to conduct thematic analysis. TATree runs in browser and is powered by the D3 Javascript library."
<span class="lineNum">44</span>        ],
<span class="lineNum">45</span>        list: ['index.html', 'js/script.js'],
<span class="lineNum">46</span>        seeMore: "./tatree/",
<span class="lineNum">47</span>        repo: "https://bitbucket.org/chrismgaeta/tatree"
<span class="lineNum">48</span>      };
<span class="lineNum">49</span>    +project(pr)
<span class="lineNum">50</span>      code.demo
<span class="lineNum">51</span>        include:escape() /code/tatree/index.html
<span class="lineNum">52</span>      code.demo
<span class="lineNum">53</span>        include:escape() /code/tatree/js/script.js
<span class="lineNum">54</span>    -
<span class="lineNum">55</span>      var pr = {
<span class="lineNum">56</span>        imgs: [],
<span class="lineNum">57</span>        name: "Portfolio Bot",
<span class="lineNum">58</span>        tech: ["Node.js", "Bots", "Machine learning"],
<span class="lineNum">59</span>        tools: ["Smooch.io", "Heroku", "Wit.ai"],
<span class="lineNum">60</span>        text: [
<span class="lineNum">61</span>          "I was working on a bot to answer questions for guests on my portfolio. The bot runs on Smooch and uses a webhook on a Heroku server.",
<span class="lineNum">62</span>          "In the future, I'd like to integrate Wit.ai to incorporate some machine learning and make the bot smarter."
<span class="lineNum">63</span>        ],
<span class="lineNum">64</span>        list: [],
<span class="lineNum">65</span>        seeMore: "./portfolioBot/",
<span class="lineNum">66</span>        repo: "https://bitbucket.org/chrismgaeta/portfoliobot"
<span class="lineNum">67</span>      };
<span class="lineNum">68</span>    +project(pr)
<span class="lineNum">69</span>    -
<span class="lineNum">70</span>      var pr = {
<span class="lineNum">71</span>        imgs: [],
<span class="lineNum">72</span>        name: "Sudoku Solver",
<span class="lineNum">73</span>        tech: ["MVC"],
<span class="lineNum">74</span>        tools: ["Angular1"],
<span class="lineNum">75</span>        text: [
<span class="lineNum">76</span>          "To experiment with Angular.js modules, services, and data-binding, I created a naive, constraint-based sudoku solver."
<span class="lineNum">77</span>        ],
<span class="lineNum">78</span>        list: ["index.html", "app.module.js", 'css/styles.css'],
<span class="lineNum">79</span>        seeMore: "./sudoku/",
<span class="lineNum">80</span>        repo: "https://bitbucket.org/chrismgaeta/sudoku_solver"
<span class="lineNum">81</span>      };
<span class="lineNum">82</span>    +project(pr)
<span class="lineNum">83</span>      code.demo
<span class="lineNum">84</span>        include:escape() /code/sudoku/index.html
<span class="lineNum">85</span>      code.demo
<span class="lineNum">86</span>        include:escape() /code/sudoku/app/app.module.js
<span class="lineNum">87</span>      code.demo
<span class="lineNum">88</span>        include:escape() /code/sudoku/css/styles.css
<span class="lineNum">89</span>    -
<span class="lineNum">90</span>      var pr = {
<span class="lineNum">91</span>        imgs: [],
<span class="lineNum">92</span>        name: "Picross Solver",
<span class="lineNum">93</span>        tech: ["MVC", "Typescript"],
<span class="lineNum">94</span>        tools: ["Angular2"],
<span class="lineNum">95</span>        text: [
<span class="lineNum">96</span>          "To familiarize myself with Angular2 and Typescript, I started on a web app to solve nonograms."
<span class="lineNum">97</span>        ],
<span class="lineNum">98</span>        list: ['app.component.ts', 'grid.service.ts', 'line.ts', 'square.ts', 'hint.ts'],
<span class="lineNum">99</span>        seeMore: "./picross/",
<span class="lineNum">100</span>        repo: "https://bitbucket.org/chrismgaeta/angular2_picross"
<span class="lineNum">101</span>      };
<span class="lineNum">102</span>    +project(pr)
<span class="lineNum">103</span>      code.demo
<span class="lineNum">104</span>        include:escape() /code/picross/app/app.component.ts
<span class="lineNum">105</span>      code.demo
<span class="lineNum">106</span>        include:escape() /code/picross/app/grid.service.ts
<span class="lineNum">107</span>      code.demo
<span class="lineNum">108</span>        include:escape() /code/picross/app/line.ts
<span class="lineNum">109</span>      code.demo
<span class="lineNum">110</span>        include:escape() /code/picross/app/square.ts
<span class="lineNum">111</span>      code.demo
<span class="lineNum">112</span>        include:escape() /code/picross/app/hint.ts
<span class="lineNum">113</span></code></pre></div></div><div class="projects"><div class="projectdesc"><h2 class="projectName">TATree</h2><ul class="technology"><li>Data vis</li></ul><ul class="tools"><li>D3</li></ul><p class="projectText">TATree is a data visualization tool I created for myself to conduct thematic analysis. TATree runs in browser and is powered by the D3 Javascript library.</p><a class="seeMore btn" href="./tatree/" target="_blank">Try it</a><!--a.bitbucketRepo.btn(href=p.repo target="_blank") See the repo--></div><div class="demoCont"><ul class="demoFiles"><li class="selected">index.html</li><li>js/script.js</li></ul><pre><code class="demo"><span class="lineNum">1</span>&lt;!DOCTYPE html&gt;
<span class="lineNum">2</span>&lt;html&gt;
<span class="lineNum">3</span>&lt;head&gt;
<span class="lineNum">4</span>  &lt;meta charset="utf-8"&gt;
<span class="lineNum">5</span>  &lt;title&gt;Test&lt;/title&gt;
<span class="lineNum">6</span>  &lt;script type="text/javascript" src="js/d3.js"&gt;&lt;/script&gt;
<span class="lineNum">7</span>  &lt;script type="text/javascript" src="js/script.js"&gt;&lt;/script&gt;
<span class="lineNum">8</span>  &lt;link rel="stylesheet" href="css/styles.css"&gt;
<span class="lineNum">9</span>&lt;/head&gt;
<span class="lineNum">10</span>&lt;body&gt;
<span class="lineNum">11</span>  &lt;div id="view"&gt;&lt;/div&gt;
<span class="lineNum">12</span>  &lt;div id="zoomCtls"&gt;
<span class="lineNum">13</span>    &lt;button id="zoomIn"&gt;+&lt;/button&gt;
<span class="lineNum">14</span>    &lt;button id="zoomOut"&gt;-&lt;/button&gt;
<span class="lineNum">15</span>  &lt;/div&gt;
<span class="lineNum">16</span>  &lt;div id="script"&gt;&lt;/div&gt;
<span class="lineNum">17</span>  &lt;div id="network"&gt;&lt;/div&gt;
<span class="lineNum">18</span>  &lt;div id="controls"&gt;
<span class="lineNum">19</span>    &lt;label&gt;JSON file to analyze:&lt;/label&gt;
<span class="lineNum">20</span>    &lt;input type="file" id="fileField" /&gt;
<span class="lineNum">21</span>    &lt;label&gt;Add transcript&lt;/label&gt;
<span class="lineNum">22</span>    &lt;input type="file" id="transcriptField" /&gt;
<span class="lineNum">23</span>    &lt;label&gt;Show Transcript&lt;/label&gt;
<span class="lineNum">24</span>    &lt;select id="showTranscript"&gt;&lt;/select&gt;
<span class="lineNum">25</span>    &lt;button id="toggleTranscript"&gt;Toggle Transcript&lt;/button&gt;
<span class="lineNum">26</span>    &lt;form&gt;
<span class="lineNum">27</span>      &lt;label&gt;Add node&lt;/label&gt;
<span class="lineNum">28</span>      &lt;input type="text" id="nodeField" /&gt;
<span class="lineNum">29</span>      &lt;input type="submit" value="Insert" id="insertNode" /&gt;
<span class="lineNum">30</span>    &lt;/form&gt;
<span class="lineNum">31</span>    &lt;button id="encodeSelection"&gt;Encode selection&lt;/button&gt;
<span class="lineNum">32</span>    &lt;label&gt;Node Context&lt;/label&gt;
<span class="lineNum">33</span>    &lt;p id="nodeContext"&gt;&lt;/p&gt;
<span class="lineNum">34</span>  &lt;/div&gt;
<span class="lineNum">35</span>  &lt;div id="copy"&gt;
<span class="lineNum">36</span>  	&lt;label&gt;Click below to copy JSON&lt;/label&gt;
<span class="lineNum">37</span>  	&lt;p id="json"&gt;&lt;/p&gt;
<span class="lineNum">38</span>  &lt;/div&gt;
<span class="lineNum">39</span>&lt;/body&gt;
<span class="lineNum">40</span>&lt;/html&gt;
<span class="lineNum">41</span></code><code class="demo"><span class="lineNum">1</span>var data = null;
<span class="lineNum">2</span>var transcripts = [];
<span class="lineNum">3</span>
<span class="lineNum">4</span>var currTransc = 0;
<span class="lineNum">5</span>var colors = [];
<span class="lineNum">6</span>
<span class="lineNum">7</span>var z = 0;
<span class="lineNum">8</span>var total = 0;
<span class="lineNum">9</span>var nodeDepths = [];
<span class="lineNum">10</span>var strLen = 0;
<span class="lineNum">11</span>
<span class="lineNum">12</span>var dragging = null;
<span class="lineNum">13</span>var selected = null;
<span class="lineNum">14</span>var highlighted = null;
<span class="lineNum">15</span>
<span class="lineNum">16</span>var dragStEvent = null;
<span class="lineNum">17</span>
<span class="lineNum">18</span>var dragListener = d3.behavior.drag()
<span class="lineNum">19</span>  .on("dragstart", function(d){
<span class="lineNum">20</span>    if(d.parent == null) return;
<span class="lineNum">21</span>    dragStEvent = d3.event;
<span class="lineNum">22</span>  })
<span class="lineNum">23</span>  .on("drag", function(d){
<span class="lineNum">24</span>    if(d.parent == null) return;
<span class="lineNum">25</span>    d.x0 += d3.event.dy;
<span class="lineNum">26</span>    d.y0 += d3.event.dx;
<span class="lineNum">27</span>    var n = d3.select(this);
<span class="lineNum">28</span>    n.attr("transform", "translate("+d.y0+","+d.x0+")");
<span class="lineNum">29</span>  })
<span class="lineNum">30</span>  .on("dragend", function(d){
<span class="lineNum">31</span>    if(dragStEvent == null) return;
<span class="lineNum">32</span>
<span class="lineNum">33</span>    // simply clicked on a node?
<span class="lineNum">34</span>    if((matchTest(selected) || selected === null)){
<span class="lineNum">35</span>
<span class="lineNum">36</span>      dragging = null;
<span class="lineNum">37</span>
<span class="lineNum">38</span>      var delta = {};
<span class="lineNum">39</span>
<span class="lineNum">40</span>      delta.x = Math.abs(d3.event.sourceEvent.clientX - dragStEvent.sourceEvent.clientX),
<span class="lineNum">41</span>        delta.y = Math.abs(d3.event.sourceEvent.clientY - dragStEvent.sourceEvent.clientY);
<span class="lineNum">42</span>
<span class="lineNum">43</span>      // clicked near origin - treat event as just a click
<span class="lineNum">44</span>      if(delta.x &lt; 5 &amp;&amp; delta.y &lt; 5){
<span class="lineNum">45</span>        if(this !== highlighted){
<span class="lineNum">46</span>          if(highlighted != null){
<span class="lineNum">47</span>            d3.select(highlighted)
<span class="lineNum">48</span>              .attr("fill", "#000000");
<span class="lineNum">49</span>          }
<span class="lineNum">50</span>            //d3.select(highlighted).classed("highlighted", false);
<span class="lineNum">51</span>          highlighted = this;
<span class="lineNum">52</span>          d3.select(this)
<span class="lineNum">53</span>            .attr("fill", "#4499FF");
<span class="lineNum">54</span>
<span class="lineNum">55</span>        }
<span class="lineNum">56</span>        else{
<span class="lineNum">57</span>          hideChildren(d);
<span class="lineNum">58</span>          d3.select(this).classed("collapsedParent", d._children);
<span class="lineNum">59</span>        }
<span class="lineNum">60</span>      }
<span class="lineNum">61</span>
<span class="lineNum">62</span>      //update(d);
<span class="lineNum">63</span>      update(data);
<span class="lineNum">64</span>      dragStEvent = null;
<span class="lineNum">65</span>      selected = null;
<span class="lineNum">66</span>
<span class="lineNum">67</span>      return;
<span class="lineNum">68</span>    }
<span class="lineNum">69</span>    else{
<span class="lineNum">70</span>
<span class="lineNum">71</span>      endDrag(selected);
<span class="lineNum">72</span>      update(data);
<span class="lineNum">73</span>
<span class="lineNum">74</span>      return;
<span class="lineNum">75</span>    }
<span class="lineNum">76</span>
<span class="lineNum">77</span>  });
<span class="lineNum">78</span>
<span class="lineNum">79</span>var tree = d3.layout.tree()
<span class="lineNum">80</span>  .sort(null)
<span class="lineNum">81</span>  .size([4000, 480])
<span class="lineNum">82</span>  .children(function(d){
<span class="lineNum">83</span>    return(!d.children || d.children.length === 0) ? null : d.children;
<span class="lineNum">84</span>  })
<span class="lineNum">85</span>  .separation(function(a, b){
<span class="lineNum">86</span>    if(!(hasChildren(a) || hasChildren(b)))
<span class="lineNum">87</span>      return a.parent === b.parent ? 3 : 4;
<span class="lineNum">88</span>    else
<span class="lineNum">89</span>      return a.parent === b.parent ? 5 : 7;
<span class="lineNum">90</span>  });
<span class="lineNum">91</span>
<span class="lineNum">92</span>var link = d3.svg.diagonal()
<span class="lineNum">93</span>  .projection(function(d){
<span class="lineNum">94</span>    return [d.y, d.x];
<span class="lineNum">95</span>  });
<span class="lineNum">96</span>
<span class="lineNum">97</span>var layoutRoot = d3.select("#view")
<span class="lineNum">98</span>.append("svg:svg")
<span class="lineNum">99</span>.attr("width", 1600)
<span class="lineNum">100</span>.attr("height", 8000)
<span class="lineNum">101</span>.append("svg:g")
<span class="lineNum">102</span>.attr("class", "container")
<span class="lineNum">103</span>.attr("transform", "translate(60, 0)");
<span class="lineNum">104</span>
<span class="lineNum">105</span>var tempCat = localStorage.categories != undefined ? JSON.parse(localStorage.categories) : undefined;
<span class="lineNum">106</span>var categories = tempCat ? tempCat.nodes : [];
<span class="lineNum">107</span>var tempFLinks = tempCat ? tempCat.links: [];
<span class="lineNum">108</span>var fLinks = [];
<span class="lineNum">109</span>
<span class="lineNum">110</span>for(var i = 0; i &lt; tempFLinks.length; i++){
<span class="lineNum">111</span>  var l = tempFLinks[i]
<span class="lineNum">112</span>
<span class="lineNum">113</span>  if(!l.source) continue;
<span class="lineNum">114</span>
<span class="lineNum">115</span>  var s = categories[l.source.index];
<span class="lineNum">116</span>  var t = categories[l.target.index];
<span class="lineNum">117</span>  fLinks.push({source: s, target: t});
<span class="lineNum">118</span>
<span class="lineNum">119</span>  if(s.weight)
<span class="lineNum">120</span>    s.weight++;
<span class="lineNum">121</span>  else
<span class="lineNum">122</span>    s.weight = 1;
<span class="lineNum">123</span>
<span class="lineNum">124</span>  if(t.weight)
<span class="lineNum">125</span>    t.weight++;
<span class="lineNum">126</span>  else
<span class="lineNum">127</span>    t.weight = 1;
<span class="lineNum">128</span>}
<span class="lineNum">129</span>
<span class="lineNum">130</span>var force = d3.layout.force()
<span class="lineNum">131</span>  .size([3200, 3200])
<span class="lineNum">132</span>  .nodes(categories)
<span class="lineNum">133</span>  .links(fLinks)
<span class="lineNum">134</span>  .linkDistance(100)
<span class="lineNum">135</span>  .charge(-600)
<span class="lineNum">136</span>  .on("tick", tick);
<span class="lineNum">137</span>
<span class="lineNum">138</span>var forceRoot = d3.select("#network")
<span class="lineNum">139</span>  .append("svg:svg")
<span class="lineNum">140</span>  .attr("width", 3200)
<span class="lineNum">141</span>  .attr("height", 3200)
<span class="lineNum">142</span>  .append("svg:g")
<span class="lineNum">143</span>  .attr("class", "container")
<span class="lineNum">144</span>  .attr("transform", "translate(100, 100)")
<span class="lineNum">145</span>  .on("mousemove", mousemove);
<span class="lineNum">146</span>
<span class="lineNum">147</span>var forceNodes = force.nodes(),
<span class="lineNum">148</span>    forceLinks = force.links(),
<span class="lineNum">149</span>    forceNode = forceRoot.selectAll('.node'),
<span class="lineNum">150</span>    forceLink = forceRoot.selectAll('.link');
<span class="lineNum">151</span>
<span class="lineNum">152</span>// mouse event vars
<span class="lineNum">153</span>var selected_node = null,
<span class="lineNum">154</span>  selected_link = null,
<span class="lineNum">155</span>  mousedown_link = null,
<span class="lineNum">156</span>  mousedown_node = null,
<span class="lineNum">157</span>  mouseup_node = null;
<span class="lineNum">158</span>
<span class="lineNum">159</span>var drag_line = forceRoot.append("line")
<span class="lineNum">160</span>  .attr("class", "drag_line")
<span class="lineNum">161</span>  .attr("x1", 0)
<span class="lineNum">162</span>  .attr("y1", 0)
<span class="lineNum">163</span>  .attr("x2", 0)
<span class="lineNum">164</span>  .attr("y2", 0);
<span class="lineNum">165</span>
<span class="lineNum">166</span>forceDraw();
<span class="lineNum">167</span>
<span class="lineNum">168</span>/*
<span class="lineNum">169</span>  draw node hierarchy
<span class="lineNum">170</span>*/
<span class="lineNum">171</span>function update(source) {
<span class="lineNum">172</span>
<span class="lineNum">173</span>  if(source == null &amp;&amp; localStorage.data){
<span class="lineNum">174</span>    source = JSON.parse(localStorage.getItem("data"));
<span class="lineNum">175</span>
<span class="lineNum">176</span>    if(source.transcripts){
<span class="lineNum">177</span>      transcripts = source.transcripts;
<span class="lineNum">178</span>
<span class="lineNum">179</span>      resetSelect();
<span class="lineNum">180</span>    }
<span class="lineNum">181</span>
<span class="lineNum">182</span>    if(source.data)
<span class="lineNum">183</span>      source = source.data;
<span class="lineNum">184</span>  }
<span class="lineNum">185</span>  else if(source == null) {
<span class="lineNum">186</span>    transcripts = ["This is an example text file being used to demonstrate TATree." +
<span class="lineNum">187</span>      " There is no useful data in this file. Qualitative data analysis is" +
<span class="lineNum">188</span>      " subjective, however, so theoretically, a researcher can assign meaning" +
<span class="lineNum">189</span>      " to this file, depending on what she is looking for.\n\n" +
<span class="lineNum">190</span>      "For my purposes, however, this file is not intended to have any meaning." +
<span class="lineNum">191</span>      " This should just be enough text to code some text and create some" +
<span class="lineNum">192</span>      " meaningless categories to represent in the tree and network views."];
<span class="lineNum">193</span>
<span class="lineNum">194</span>    source = {
<span class="lineNum">195</span>      name: "Root",
<span class="lineNum">196</span>      children: []
<span class="lineNum">197</span>    }
<span class="lineNum">198</span>
<span class="lineNum">199</span>    resetSelect();
<span class="lineNum">200</span>  };
<span class="lineNum">201</span>
<span class="lineNum">202</span>  data = source;
<span class="lineNum">203</span>
<span class="lineNum">204</span>  var hueStep = 360 / transcripts.length;
<span class="lineNum">205</span>  colors = [];
<span class="lineNum">206</span>  for(var i = 0; i &lt; transcripts.length; i++){
<span class="lineNum">207</span>    colors.push(i * hueStep);
<span class="lineNum">208</span>  }
<span class="lineNum">209</span>
<span class="lineNum">210</span>  var h = 0;
<span class="lineNum">211</span>  nodeDepths = [];
<span class="lineNum">212</span>  depthCounts(data);
<span class="lineNum">213</span>  total = countChildren(data);
<span class="lineNum">214</span>
<span class="lineNum">215</span>  var newHeight = d3.max(nodeDepths) * 60;
<span class="lineNum">216</span>  newHeight = Math.max(newHeight, 640);
<span class="lineNum">217</span>
<span class="lineNum">218</span>  var newWidth = Math.max(strLen * 3 * nodeDepths.length, 800);
<span class="lineNum">219</span>
<span class="lineNum">220</span>  tree = tree.size([newHeight, newWidth]);
<span class="lineNum">221</span>
<span class="lineNum">222</span>  var svgCanvas = document.getElementById("view").firstChild
<span class="lineNum">223</span>  svgCanvas.setAttribute("height", newHeight);
<span class="lineNum">224</span>  svgCanvas.setAttribute("width", newWidth * 2);
<span class="lineNum">225</span>
<span class="lineNum">226</span>  var nodes = tree.nodes(data);
<span class="lineNum">227</span>  var links = tree.links(nodes);
<span class="lineNum">228</span>
<span class="lineNum">229</span>  layoutRoot.selectAll("path.link")
<span class="lineNum">230</span>    .data(links)
<span class="lineNum">231</span>    .enter()
<span class="lineNum">232</span>    .append("svg:path")
<span class="lineNum">233</span>    .attr("class", "link")
<span class="lineNum">234</span>    .attr("d", link);
<span class="lineNum">235</span>
<span class="lineNum">236</span>  var node = layoutRoot.selectAll("g.node")
<span class="lineNum">237</span>    .data(nodes, function(d){
<span class="lineNum">238</span>      return d.id || (d.id = ++z);
<span class="lineNum">239</span>    });
<span class="lineNum">240</span>
<span class="lineNum">241</span>  var nodeGroup = node.enter().append("svg:g")
<span class="lineNum">242</span>    .call(dragListener)
<span class="lineNum">243</span>    .attr("class", function(d){
<span class="lineNum">244</span>      return d._children ? "node collapsedParent" : "node";
<span class="lineNum">245</span>    })
<span class="lineNum">246</span>    .attr("transform", function(d){
<span class="lineNum">247</span>      return "translate("+(d.depth * 100)+","+d.x+")";
<span class="lineNum">248</span>    })
<span class="lineNum">249</span>    .on('mousedown', function(d){
<span class="lineNum">250</span>      startDrag(d);
<span class="lineNum">251</span>    })
<span class="lineNum">252</span>    .on("mouseover", function(d){
<span class="lineNum">253</span>      if(dragging &amp;&amp; d !== dragging)
<span class="lineNum">254</span>        selected = d;
<span class="lineNum">255</span>      if(d.transcript){
<span class="lineNum">256</span>        var str = transcripts[d.transcript];
<span class="lineNum">257</span>        var s = d.start &gt; 80 ? d.start - 80 : 0;
<span class="lineNum">258</span>        var e = str.length &gt; d.end + 80 ? d.end + 80 : str.length;
<span class="lineNum">259</span>
<span class="lineNum">260</span>        var sub = str.substr(s, e-s);
<span class="lineNum">261</span>        nodeContext.textContent = sub;
<span class="lineNum">262</span>
<span class="lineNum">263</span>      }
<span class="lineNum">264</span>      else if(d.name != undefined)
<span class="lineNum">265</span>        nodeContext.textContent = d.name;
<span class="lineNum">266</span>    })
<span class="lineNum">267</span>    .on("mouseout", function(d){
<span class="lineNum">268</span>      if(dragging &amp;&amp; d !== dragging)
<span class="lineNum">269</span>        selected = null;
<span class="lineNum">270</span>      nodeContext.textContent = "";
<span class="lineNum">271</span>    });
<span class="lineNum">272</span>
<span class="lineNum">273</span>  nodeGroup.append("svg:circle")
<span class="lineNum">274</span>    .attr("class", "node-dot")
<span class="lineNum">275</span>    .attr("r", 5)
<span class="lineNum">276</span>    .attr("fill", function(d){
<span class="lineNum">277</span>      //console.log(d.transcript);
<span class="lineNum">278</span>      //if(d.transcript != undefined) console.log(colors[d.transcript]);
<span class="lineNum">279</span>      return "hsl("+ (d.transcript != undefined ? colors[d.transcript] : 0)+", 100%, "+(d.transcript != undefined ? 50 : 0) + "%)"
<span class="lineNum">280</span>    });
<span class="lineNum">281</span>
<span class="lineNum">282</span>  nodeGroup.append("svg:text")
<span class="lineNum">283</span>    .attr("text-anchor", function(d){
<span class="lineNum">284</span>      return d.children ? "end" : "start";
<span class="lineNum">285</span>    })
<span class="lineNum">286</span>    .attr("dx", function(d){
<span class="lineNum">287</span>      var gap = 20;
<span class="lineNum">288</span>      return d.children ? -gap : gap;
<span class="lineNum">289</span>    })
<span class="lineNum">290</span>    .attr("dy", function(d){
<span class="lineNum">291</span>      return (d.children) ? -15 : 3;
<span class="lineNum">292</span>    })
<span class="lineNum">293</span>    .text(function(d){
<span class="lineNum">294</span>      return d.name;
<span class="lineNum">295</span>    });
<span class="lineNum">296</span>
<span class="lineNum">297</span>  var nodeUpdate = node.transition()
<span class="lineNum">298</span>    .duration(300)
<span class="lineNum">299</span>    .attr("transform", function(d){
<span class="lineNum">300</span>
<span class="lineNum">301</span>      if(d._children){
<span class="lineNum">302</span>        d.count = countChildren(d);
<span class="lineNum">303</span>        h += d.count / total * 5;
<span class="lineNum">304</span>      }
<span class="lineNum">305</span>      else
<span class="lineNum">306</span>        d.count = 0;
<span class="lineNum">307</span>
<span class="lineNum">308</span>    //d.x = 20 + 20 * h++;
<span class="lineNum">309</span>    //d.y = 80 * d.depth;
<span class="lineNum">310</span>
<span class="lineNum">311</span>    if(total &gt; 0)
<span class="lineNum">312</span>      h += d.count / total * 5;
<span class="lineNum">313</span>
<span class="lineNum">314</span>    return "translate(" + d.y + "," + d.x + ")";
<span class="lineNum">315</span>  });
<span class="lineNum">316</span>
<span class="lineNum">317</span>  nodeUpdate.select("circle")
<span class="lineNum">318</span>    .attr("r", function(d){
<span class="lineNum">319</span>
<span class="lineNum">320</span>      if(d._children){
<span class="lineNum">321</span>        d.count = countChildren(d);
<span class="lineNum">322</span>      }
<span class="lineNum">323</span>      else
<span class="lineNum">324</span>        d.count = 0;
<span class="lineNum">325</span>
<span class="lineNum">326</span>      return total === 0 ? 5 : 5 + d.count / total * 50;
<span class="lineNum">327</span>    });
<span class="lineNum">328</span>
<span class="lineNum">329</span>  nodeUpdate.select("text")
<span class="lineNum">330</span>    .style("fill-opacity", 1)
<span class="lineNum">331</span>    .attr("text-anchor", function(d){
<span class="lineNum">332</span>      return d.parent ? d.children ? "end" : "start" : "end";
<span class="lineNum">333</span>    })
<span class="lineNum">334</span>    .attr("dx", function(d){
<span class="lineNum">335</span>      return d.parent ? d.children ? 0 : d._children ? 25 : 20 : -10;
<span class="lineNum">336</span>    })
<span class="lineNum">337</span>    .attr("dy", function(d){
<span class="lineNum">338</span>      return d.parent &amp;&amp; d.children ? 15 : 3;
<span class="lineNum">339</span>    });
<span class="lineNum">340</span>
<span class="lineNum">341</span>  var nodeExit = node.exit().transition()
<span class="lineNum">342</span>    .duration(300)
<span class="lineNum">343</span>    .attr("style", "hidden")
<span class="lineNum">344</span>    .remove();
<span class="lineNum">345</span>
<span class="lineNum">346</span>  nodeExit.select("circle")
<span class="lineNum">347</span>    .attr("r", 1e-6);
<span class="lineNum">348</span>
<span class="lineNum">349</span>  nodeExit.select("text")
<span class="lineNum">350</span>    .style("fill-opacity", 1e-6);
<span class="lineNum">351</span>
<span class="lineNum">352</span>  var nuLink = layoutRoot.selectAll("path.link")
<span class="lineNum">353</span>    .data(tree.links(nodes), function(d){
<span class="lineNum">354</span>      return d.target.id;
<span class="lineNum">355</span>    });
<span class="lineNum">356</span>
<span class="lineNum">357</span>  nuLink.enter().insert("svg:path", "g")
<span class="lineNum">358</span>    .attr("class", "link")
<span class="lineNum">359</span>    .attr("d", function(d){
<span class="lineNum">360</span>      var o = {x: source.x0, y: source.y0};
<span class="lineNum">361</span>      return link({source: o, target: o});
<span class="lineNum">362</span>    })
<span class="lineNum">363</span>    .transition()
<span class="lineNum">364</span>    .duration(300)
<span class="lineNum">365</span>    .attr("d", link);
<span class="lineNum">366</span>
<span class="lineNum">367</span>  nuLink.transition()
<span class="lineNum">368</span>  .duration(300)
<span class="lineNum">369</span>  .attr("d", link);
<span class="lineNum">370</span>
<span class="lineNum">371</span>  nuLink.exit().transition()
<span class="lineNum">372</span>  .duration(300)
<span class="lineNum">373</span>  .attr("d", function(d){
<span class="lineNum">374</span>    var o = {x: source.x, y: source.y};
<span class="lineNum">375</span>  })
<span class="lineNum">376</span>  .remove();
<span class="lineNum">377</span>
<span class="lineNum">378</span>  nodes.forEach(function(d){
<span class="lineNum">379</span>    d.x0 = d.x;
<span class="lineNum">380</span>    d.y0 = d.y;
<span class="lineNum">381</span>  });
<span class="lineNum">382</span>
<span class="lineNum">383</span>  var saveData = {data: getJSON(data), transcripts: transcripts};
<span class="lineNum">384</span>
<span class="lineNum">385</span>  document.getElementById("json").innerHTML = JSON.stringify(saveData, null, 4);
<span class="lineNum">386</span>  localStorage.setItem("data", JSON.stringify(saveData));
<span class="lineNum">387</span>
<span class="lineNum">388</span>}
<span class="lineNum">389</span>
<span class="lineNum">390</span>function forceDraw(){
<span class="lineNum">391</span>
<span class="lineNum">392</span>  forceLink = forceLink.data(forceLinks);
<span class="lineNum">393</span>
<span class="lineNum">394</span>  forceNode = forceNode.data(forceNodes);
<span class="lineNum">395</span>
<span class="lineNum">396</span>  //var forceGroup.enter().append("svg:g")
<span class="lineNum">397</span>  forceNode.enter().append("svg:g");
<span class="lineNum">398</span>
<span class="lineNum">399</span>  //forceNode.enter().insert("circle")
<span class="lineNum">400</span>  forceNode.append("circle")
<span class="lineNum">401</span>    .attr("class", "node")
<span class="lineNum">402</span>    .attr("r", 8)
<span class="lineNum">403</span>    .on("mousedown", function(d){
<span class="lineNum">404</span>
<span class="lineNum">405</span>      mousedown_node = d;
<span class="lineNum">406</span>      if (mousedown_node == selected_node)
<span class="lineNum">407</span>        selected_node = null;
<span class="lineNum">408</span>      else selected_node = mousedown_node;
<span class="lineNum">409</span>        selected_link = null;
<span class="lineNum">410</span>
<span class="lineNum">411</span>      // reposition drag line
<span class="lineNum">412</span>      drag_line
<span class="lineNum">413</span>        //.attr("class", "link")
<span class="lineNum">414</span>        .attr("class", "drag_line")
<span class="lineNum">415</span>        .attr("x1", mousedown_node.x)
<span class="lineNum">416</span>        .attr("y1", mousedown_node.y)
<span class="lineNum">417</span>        .attr("x2", mousedown_node.x)
<span class="lineNum">418</span>        .attr("y2", mousedown_node.y);
<span class="lineNum">419</span>
<span class="lineNum">420</span>      forceDraw();
<span class="lineNum">421</span>    })
<span class="lineNum">422</span>    .on("mouseup", function(d){
<span class="lineNum">423</span>      finishLine();
<span class="lineNum">424</span>      if(mousedown_node){
<span class="lineNum">425</span>        mouseup_node = d;
<span class="lineNum">426</span>        if (mouseup_node == mousedown_node){
<span class="lineNum">427</span>          mousedown_node = null;
<span class="lineNum">428</span>          mouseup_node = null;
<span class="lineNum">429</span>          mousedown_link = null;
<span class="lineNum">430</span>
<span class="lineNum">431</span>          return;
<span class="lineNum">432</span>        }
<span class="lineNum">433</span>
<span class="lineNum">434</span>        // add link
<span class="lineNum">435</span>        var link = {
<span class="lineNum">436</span>          source: mousedown_node,
<span class="lineNum">437</span>          target: mouseup_node
<span class="lineNum">438</span>        };
<span class="lineNum">439</span>        forceLinks.push(link);
<span class="lineNum">440</span>
<span class="lineNum">441</span>        // select new link
<span class="lineNum">442</span>        selected_link = link;
<span class="lineNum">443</span>        selected_node = null;
<span class="lineNum">444</span>
<span class="lineNum">445</span>        forceDraw();
<span class="lineNum">446</span>      }
<span class="lineNum">447</span>    })
<span class="lineNum">448</span>    .transition()
<span class="lineNum">449</span>      .duration(750)
<span class="lineNum">450</span>      .ease("elastic")
<span class="lineNum">451</span>      .attr("r", 9);
<span class="lineNum">452</span>
<span class="lineNum">453</span>  forceNode.append("svg:text")
<span class="lineNum">454</span>    .attr("text-anchor", function(d){
<span class="lineNum">455</span>      return "start";
<span class="lineNum">456</span>    })
<span class="lineNum">457</span>    .attr("dx", function(d){
<span class="lineNum">458</span>      return 20;
<span class="lineNum">459</span>    })
<span class="lineNum">460</span>    .attr("dy", function(d){
<span class="lineNum">461</span>      return 3;
<span class="lineNum">462</span>    })
<span class="lineNum">463</span>    .text(function(d){
<span class="lineNum">464</span>      return d.name;
<span class="lineNum">465</span>    });
<span class="lineNum">466</span>
<span class="lineNum">467</span>  forceNode.exit().transition()
<span class="lineNum">468</span>    .attr("r", 0)
<span class="lineNum">469</span>    .remove();
<span class="lineNum">470</span>
<span class="lineNum">471</span>  forceNode.classed("node_selected", function(d){
<span class="lineNum">472</span>    return d === selected_node;
<span class="lineNum">473</span>  });
<span class="lineNum">474</span>
<span class="lineNum">475</span>  forceLink.enter().append("line")
<span class="lineNum">476</span>    .attr("class", "link")
<span class="lineNum">477</span>    .on("mousedown", function(d){
<span class="lineNum">478</span>      mousedown_link = d;
<span class="lineNum">479</span>      if (mousedown_link == selected_link)
<span class="lineNum">480</span>        selected_link = null;
<span class="lineNum">481</span>      else selected_link = mousedown_link;
<span class="lineNum">482</span>        selected_node = null;
<span class="lineNum">483</span>      forceDraw();
<span class="lineNum">484</span>    });
<span class="lineNum">485</span>
<span class="lineNum">486</span>  forceLink.exit().remove();
<span class="lineNum">487</span>
<span class="lineNum">488</span>  forceLink.classed("link_selected", function(d){
<span class="lineNum">489</span>    return d === selected_link;
<span class="lineNum">490</span>  });
<span class="lineNum">491</span>
<span class="lineNum">492</span>  if (d3.event) {
<span class="lineNum">493</span>    // prevent browser's default behavior
<span class="lineNum">494</span>    d3.event.preventDefault();
<span class="lineNum">495</span>  }
<span class="lineNum">496</span>
<span class="lineNum">497</span>  localStorage.categories = JSON.stringify({ nodes: categories, links: forceLinks });
<span class="lineNum">498</span>
<span class="lineNum">499</span>  force.start();
<span class="lineNum">500</span>
<span class="lineNum">501</span>}
<span class="lineNum">502</span>
<span class="lineNum">503</span>function resetSelect(){
<span class="lineNum">504</span>  var selectEl = document.querySelector('#showTranscript');
<span class="lineNum">505</span>  while(selectEl.firstChild)
<span class="lineNum">506</span>    selectEl.removeChild(selectEl.firstChild);
<span class="lineNum">507</span>
<span class="lineNum">508</span>  for(var i = 0; i &lt; transcripts.length; i++){
<span class="lineNum">509</span>    var opt = document.createElement('option');
<span class="lineNum">510</span>    opt.appendChild(document.createTextNode(i))
<span class="lineNum">511</span>    selectEl.appendChild(opt);
<span class="lineNum">512</span>
<span class="lineNum">513</span>    if(i + 2 &gt; transcripts.length)
<span class="lineNum">514</span>      opt.setAttribute("selected", "selected");
<span class="lineNum">515</span>  }
<span class="lineNum">516</span>
<span class="lineNum">517</span>  showTranscript(selectEl.value);
<span class="lineNum">518</span>}
<span class="lineNum">519</span>
<span class="lineNum">520</span>/*
<span class="lineNum">521</span>  return whether the node has children
<span class="lineNum">522</span>*/
<span class="lineNum">523</span>function hasChildren(d){
<span class="lineNum">524</span>  return (true &amp;&amp; d.children || d._children);
<span class="lineNum">525</span>}
<span class="lineNum">526</span>
<span class="lineNum">527</span>/*
<span class="lineNum">528</span>  hide the nodes children
<span class="lineNum">529</span>*/
<span class="lineNum">530</span>function hideChildren(d){
<span class="lineNum">531</span>  if(!d) return;
<span class="lineNum">532</span>  if(d.children){
<span class="lineNum">533</span>    d._children = d.children;
<span class="lineNum">534</span>    d.children = null;
<span class="lineNum">535</span>  }
<span class="lineNum">536</span>  else{
<span class="lineNum">537</span>    d.children = d._children;
<span class="lineNum">538</span>    d._children = null;
<span class="lineNum">539</span>  }
<span class="lineNum">540</span>
<span class="lineNum">541</span>}
<span class="lineNum">542</span>
<span class="lineNum">543</span>function iterateNodes(d, fn){
<span class="lineNum">544</span>
<span class="lineNum">545</span>  var c = d.children || d._children;
<span class="lineNum">546</span>
<span class="lineNum">547</span>  if(c != null || c != undefined)
<span class="lineNum">548</span>    for(var i = 0; i &lt; c.length; i++)
<span class="lineNum">549</span>      iterateNodes(c[i], fn);
<span class="lineNum">550</span>
<span class="lineNum">551</span>  fn(d);
<span class="lineNum">552</span>}
<span class="lineNum">553</span>
<span class="lineNum">554</span>/*
<span class="lineNum">555</span>  count the node's children
<span class="lineNum">556</span>*/
<span class="lineNum">557</span>function countChildren(d){
<span class="lineNum">558</span>
<span class="lineNum">559</span>  if(d == null) return 0;
<span class="lineNum">560</span>
<span class="lineNum">561</span>  var c = 0;
<span class="lineNum">562</span>
<span class="lineNum">563</span>  if(d.children){
<span class="lineNum">564</span>    c = d.children.length;
<span class="lineNum">565</span>
<span class="lineNum">566</span>    for(var i = 0; i &lt; d.children.length; i++)
<span class="lineNum">567</span>      c += countChildren(d.children[i]);
<span class="lineNum">568</span>  }
<span class="lineNum">569</span>  else if(d._children){
<span class="lineNum">570</span>    c = d._children.length;
<span class="lineNum">571</span>
<span class="lineNum">572</span>    for(var i = 0; i &lt; d._children.length; i++)
<span class="lineNum">573</span>      c += countChildren(d._children[i]);
<span class="lineNum">574</span>  }
<span class="lineNum">575</span>
<span class="lineNum">576</span>  return c;
<span class="lineNum">577</span>
<span class="lineNum">578</span>}
<span class="lineNum">579</span>
<span class="lineNum">580</span>function countLeaves(d){
<span class="lineNum">581</span>
<span class="lineNum">582</span>  var c = 0;
<span class="lineNum">583</span>
<span class="lineNum">584</span>  if(d.children){
<span class="lineNum">585</span>
<span class="lineNum">586</span>    for(var i = 0; i &lt; d.children.length; i++)
<span class="lineNum">587</span>      c += countLeaves(d.children[i]);
<span class="lineNum">588</span>
<span class="lineNum">589</span>    return 0;
<span class="lineNum">590</span>
<span class="lineNum">591</span>  }
<span class="lineNum">592</span>
<span class="lineNum">593</span>  else
<span class="lineNum">594</span>    return 1;
<span class="lineNum">595</span>
<span class="lineNum">596</span>}
<span class="lineNum">597</span>
<span class="lineNum">598</span>function depthCounts(d, l){
<span class="lineNum">599</span>
<span class="lineNum">600</span>  if(d == null)
<span class="lineNum">601</span>    return 0;
<span class="lineNum">602</span>
<span class="lineNum">603</span>  if(!l)
<span class="lineNum">604</span>    l = 0;
<span class="lineNum">605</span>
<span class="lineNum">606</span>  strLen = Math.max(strLen, d.name.length);
<span class="lineNum">607</span>
<span class="lineNum">608</span>  if(!nodeDepths[l])
<span class="lineNum">609</span>    nodeDepths[l] = 1;
<span class="lineNum">610</span>
<span class="lineNum">611</span>  else
<span class="lineNum">612</span>    nodeDepths[l] += 1;
<span class="lineNum">613</span>
<span class="lineNum">614</span>  var ch = d.children;
<span class="lineNum">615</span>
<span class="lineNum">616</span>  if(ch){
<span class="lineNum">617</span>    for(var i = 0; i &lt; ch.length; i++){
<span class="lineNum">618</span>      depthCounts(ch[i], l+1);
<span class="lineNum">619</span>    }
<span class="lineNum">620</span>  }
<span class="lineNum">621</span>
<span class="lineNum">622</span>}
<span class="lineNum">623</span>
<span class="lineNum">624</span>function startDrag(d){
<span class="lineNum">625</span>  dragging = d;
<span class="lineNum">626</span>
<span class="lineNum">627</span>  var group = d3.selectAll("g.node").sort(function(a,b){
<span class="lineNum">628</span>    if(a.id != dragging.id) return 1;
<span class="lineNum">629</span>    else return -1;
<span class="lineNum">630</span>  });
<span class="lineNum">631</span>}
<span class="lineNum">632</span>
<span class="lineNum">633</span>function endDrag(d){
<span class="lineNum">634</span>
<span class="lineNum">635</span>  if(!d){
<span class="lineNum">636</span>    return;
<span class="lineNum">637</span>  }
<span class="lineNum">638</span>
<span class="lineNum">639</span>  if(isDescendant(d)){
<span class="lineNum">640</span>    console.log("Error: cannot move node to descendant node");
<span class="lineNum">641</span>    return;
<span class="lineNum">642</span>  }
<span class="lineNum">643</span>
<span class="lineNum">644</span>  removeNode(dragging);
<span class="lineNum">645</span>  dragging.parent = d;
<span class="lineNum">646</span>
<span class="lineNum">647</span>  if(d._children){
<span class="lineNum">648</span>    d._children.push(dragging);
<span class="lineNum">649</span>  }
<span class="lineNum">650</span>  else{
<span class="lineNum">651</span>    if(!d.children)
<span class="lineNum">652</span>      d.children = [];
<span class="lineNum">653</span>
<span class="lineNum">654</span>    d.children.push(dragging);
<span class="lineNum">655</span>  }
<span class="lineNum">656</span>
<span class="lineNum">657</span>  selected = null;
<span class="lineNum">658</span>
<span class="lineNum">659</span>}
<span class="lineNum">660</span>
<span class="lineNum">661</span>function removeNode(d){
<span class="lineNum">662</span>  var parent = d.parent;
<span class="lineNum">663</span>  for(var i = 0; i &lt; parent.children.length; i++){
<span class="lineNum">664</span>    if(parent.children[i] == d){
<span class="lineNum">665</span>      parent.children.splice(i, 1);
<span class="lineNum">666</span>    }
<span class="lineNum">667</span>  }
<span class="lineNum">668</span>}
<span class="lineNum">669</span>
<span class="lineNum">670</span>function isDescendant(d){
<span class="lineNum">671</span>
<span class="lineNum">672</span>  if(!d) return false;
<span class="lineNum">673</span>
<span class="lineNum">674</span>  if(d === dragging)
<span class="lineNum">675</span>    return true;
<span class="lineNum">676</span>
<span class="lineNum">677</span>  if(d.parent &amp;&amp; isDescendant(d.parent))
<span class="lineNum">678</span>    return true;
<span class="lineNum">679</span>
<span class="lineNum">680</span>  return false;
<span class="lineNum">681</span>
<span class="lineNum">682</span>}
<span class="lineNum">683</span>
<span class="lineNum">684</span>function countPrev(t){
<span class="lineNum">685</span>  if(t.previousSibling)
<span class="lineNum">686</span>    return countPrev(t.previousSibling) + 1;
<span class="lineNum">687</span>  else
<span class="lineNum">688</span>    return 0;
<span class="lineNum">689</span>}
<span class="lineNum">690</span>
<span class="lineNum">691</span>function matchTest(d){
<span class="lineNum">692</span>  var result = dragging === d;
<span class="lineNum">693</span>  return result;
<span class="lineNum">694</span>}
<span class="lineNum">695</span>
<span class="lineNum">696</span>function tick() {
<span class="lineNum">697</span>  forceLink
<span class="lineNum">698</span>    .attr("x1", function(d){ return d.source.x; })
<span class="lineNum">699</span>    .attr("y1", function(d){ return d.source.y; })
<span class="lineNum">700</span>    .attr("x2", function(d){ return d.target.x; })
<span class="lineNum">701</span>    .attr("y2", function(d){ return d.target.y; });
<span class="lineNum">702</span>
<span class="lineNum">703</span>  forceNode
<span class="lineNum">704</span>    //.attr("cx", function(d){ return d.x; })
<span class="lineNum">705</span>    //.attr("cy", function(d){ return d.y; });
<span class="lineNum">706</span>    .attr("transform", function(d){
<span class="lineNum">707</span>      if(!isNaN(d.x))
<span class="lineNum">708</span>        return "translate("+d.x+","+d.y+")";
<span class="lineNum">709</span>      else
<span class="lineNum">710</span>        return "translate(0,0)";
<span class="lineNum">711</span>    });
<span class="lineNum">712</span>}
<span class="lineNum">713</span>
<span class="lineNum">714</span>function drawLine(){
<span class="lineNum">715</span>  // update drag line
<span class="lineNum">716</span>  drag_line
<span class="lineNum">717</span>    .attr("x1", mousedown_node.x)
<span class="lineNum">718</span>    .attr("y1", mousedown_node.y)
<span class="lineNum">719</span>    .attr("x2", d3.svg.mouse(this)[0])
<span class="lineNum">720</span>    .attr("y2", d3.svg.mouse(this)[1]);
<span class="lineNum">721</span>
<span class="lineNum">722</span>}
<span class="lineNum">723</span>
<span class="lineNum">724</span>function finishLine(){
<span class="lineNum">725</span>  if (mousedown_node) {
<span class="lineNum">726</span>    // hide drag line
<span class="lineNum">727</span>      drag_line
<span class="lineNum">728</span>        .attr("class", "drag_line_hidden");
<span class="lineNum">729</span>  }
<span class="lineNum">730</span>}
<span class="lineNum">731</span>
<span class="lineNum">732</span>function mousemove(){
<span class="lineNum">733</span>if (!mousedown_node) return;
<span class="lineNum">734</span>
<span class="lineNum">735</span>    // update drag line
<span class="lineNum">736</span>    drag_line
<span class="lineNum">737</span>      .attr("x1", mousedown_node.x)
<span class="lineNum">738</span>      .attr("y1", mousedown_node.y)
<span class="lineNum">739</span>      //console.log(this, d3.mouse(this));
<span class="lineNum">740</span>      .attr("x2", d3.mouse(this)[0])
<span class="lineNum">741</span>      .attr("y2", d3.mouse(this)[1]);
<span class="lineNum">742</span>}
<span class="lineNum">743</span>
<span class="lineNum">744</span>function getJSON(d){
<span class="lineNum">745</span>  var ob = {
<span class="lineNum">746</span>    "name": d.name,
<span class="lineNum">747</span>    "children" : []
<span class="lineNum">748</span>  };
<span class="lineNum">749</span>
<span class="lineNum">750</span>  if(d.transcript != null){
<span class="lineNum">751</span>    ob.transcript = d.transcript;
<span class="lineNum">752</span>    ob.el = d.el;
<span class="lineNum">753</span>    ob.start = d.start;
<span class="lineNum">754</span>    ob.end = d.end;
<span class="lineNum">755</span>  }
<span class="lineNum">756</span>
<span class="lineNum">757</span>  if(d.children)
<span class="lineNum">758</span>    for(var i = 0; i &lt; d.children.length; i++){
<span class="lineNum">759</span>      ob.children.push(getJSON(d.children[i]));
<span class="lineNum">760</span>    }
<span class="lineNum">761</span>
<span class="lineNum">762</span>  if(d._children){
<span class="lineNum">763</span>    for(var i = 0; i &lt; d._children.length; i++){
<span class="lineNum">764</span>      ob.children.push(getJSON(d._children[i]));
<span class="lineNum">765</span>    }
<span class="lineNum">766</span>  }
<span class="lineNum">767</span>
<span class="lineNum">768</span>  return ob;
<span class="lineNum">769</span>}
<span class="lineNum">770</span>
<span class="lineNum">771</span>function uploadJSON(e){
<span class="lineNum">772</span>  var t = e.target || window.event.srcElement;
<span class="lineNum">773</span>  var files = t.files;
<span class="lineNum">774</span>
<span class="lineNum">775</span>  if(FileReader &amp;&amp; files &amp;&amp; files.length){
<span class="lineNum">776</span>    var fr = new FileReader();
<span class="lineNum">777</span>    fr.onload = function(){
<span class="lineNum">778</span>      var ld = JSON.parse(fr.result);
<span class="lineNum">779</span>      data = ld.data;
<span class="lineNum">780</span>      transcripts = ld.transcripts;
<span class="lineNum">781</span>      update(data);
<span class="lineNum">782</span>      t.value = "";
<span class="lineNum">783</span>    }
<span class="lineNum">784</span>    fr.readAsText(files[0]);
<span class="lineNum">785</span>  }
<span class="lineNum">786</span>}
<span class="lineNum">787</span>
<span class="lineNum">788</span>function uploadTranscript(e){
<span class="lineNum">789</span>  var t = e.target || window.event.srcElement;
<span class="lineNum">790</span>  var files = t.files;
<span class="lineNum">791</span>
<span class="lineNum">792</span>  if(FileReader &amp;&amp; files &amp;&amp; files.length){
<span class="lineNum">793</span>    var fr = new FileReader();
<span class="lineNum">794</span>    fr.onload = function(){
<span class="lineNum">795</span>      transcript = fr.result;
<span class="lineNum">796</span>      transcripts.push(transcript);
<span class="lineNum">797</span>      //update(data);
<span class="lineNum">798</span>      t.value = "";
<span class="lineNum">799</span>      update(data || {name:"codes", children:{}});
<span class="lineNum">800</span>
<span class="lineNum">801</span>      resetSelect();
<span class="lineNum">802</span>    }
<span class="lineNum">803</span>    fr.readAsText(files[0]);
<span class="lineNum">804</span>  }
<span class="lineNum">805</span>}
<span class="lineNum">806</span>
<span class="lineNum">807</span>function showTranscript(ind){
<span class="lineNum">808</span>  if(transcripts.length &lt; 1)
<span class="lineNum">809</span>    return;
<span class="lineNum">810</span>
<span class="lineNum">811</span>  if(ind == undefined || ind == null){
<span class="lineNum">812</span>    currTransc++;
<span class="lineNum">813</span>
<span class="lineNum">814</span>    if(currTransc &gt; transcripts.length - 1)
<span class="lineNum">815</span>      currTransc = 0;
<span class="lineNum">816</span>  }
<span class="lineNum">817</span>  else
<span class="lineNum">818</span>    currTransc = parseInt(ind);
<span class="lineNum">819</span>
<span class="lineNum">820</span>  var scr = document.querySelector("#script");
<span class="lineNum">821</span>  while(scr.firstChild)
<span class="lineNum">822</span>    scr.removeChild(scr.firstChild);
<span class="lineNum">823</span>
<span class="lineNum">824</span>  var nodeList = [];
<span class="lineNum">825</span>  if(data)
<span class="lineNum">826</span>    iterateNodes(data, function(d){
<span class="lineNum">827</span>      if(d.transcript != null || d.transcript != undefined)
<span class="lineNum">828</span>        if(d.transcript == currTransc) nodeList.push(d);
<span class="lineNum">829</span>
<span class="lineNum">830</span>  });
<span class="lineNum">831</span>
<span class="lineNum">832</span>  nodeList.sort(function(a, b){ return b.start - a.start; });
<span class="lineNum">833</span>
<span class="lineNum">834</span>  scr.appendChild(document.createTextNode(transcripts[currTransc]));
<span class="lineNum">835</span>
<span class="lineNum">836</span>  var el = scr.firstChild;
<span class="lineNum">837</span>
<span class="lineNum">838</span>  var r = new Range();
<span class="lineNum">839</span>
<span class="lineNum">840</span>  for(var i = 0; i &lt; nodeList.length; i++){
<span class="lineNum">841</span>    r.setStart(el, nodeList[i].start);
<span class="lineNum">842</span>    r.setEnd(el, nodeList[i].end);
<span class="lineNum">843</span>
<span class="lineNum">844</span>    r.surroundContents(document.createElement('span'));
<span class="lineNum">845</span>  }
<span class="lineNum">846</span>
<span class="lineNum">847</span>}
<span class="lineNum">848</span>
<span class="lineNum">849</span>function encodeSelection(){
<span class="lineNum">850</span>  var text = "";
<span class="lineNum">851</span>  if(window.getSelection){
<span class="lineNum">852</span>    text = window.getSelection().getRangeAt(0);
<span class="lineNum">853</span>  }
<span class="lineNum">854</span>  else if(document.selection &amp;&amp; document.selection.type != "Control"){
<span class="lineNum">855</span>    text = document.selection.createRange();
<span class="lineNum">856</span>  }
<span class="lineNum">857</span>
<span class="lineNum">858</span>  var str = text.toString();
<span class="lineNum">859</span>
<span class="lineNum">860</span>  var txt = document.querySelector('#script').textContent;
<span class="lineNum">861</span>  var indStart = 0;
<span class="lineNum">862</span>  var matches = 0;
<span class="lineNum">863</span>
<span class="lineNum">864</span>  indStart = txt.indexOf(str, 0);
<span class="lineNum">865</span>  while(txt.indexOf(str, indStart+1) &gt; -1){
<span class="lineNum">866</span>    matches++;
<span class="lineNum">867</span>  }
<span class="lineNum">868</span>
<span class="lineNum">869</span>  if(matches &lt; 2){
<span class="lineNum">870</span>    var selection = {
<span class="lineNum">871</span>      name: text.toString(),
<span class="lineNum">872</span>      children: [],
<span class="lineNum">873</span>      transcript: currTransc,
<span class="lineNum">874</span>      el: countPrev(text.startContainer),
<span class="lineNum">875</span>      start: indStart,
<span class="lineNum">876</span>      end: indStart + str.length
<span class="lineNum">877</span>    }
<span class="lineNum">878</span>    if(highlighted != null)
<span class="lineNum">879</span>      addNode(d3.select(highlighted).data()[0], selection);
<span class="lineNum">880</span>    else
<span class="lineNum">881</span>      addNode(data, selection);
<span class="lineNum">882</span>
<span class="lineNum">883</span>    text.surroundContents(document.createElement('span'));
<span class="lineNum">884</span>  }
<span class="lineNum">885</span>}
<span class="lineNum">886</span>
<span class="lineNum">887</span>function addNode(parent, node){
<span class="lineNum">888</span>  if(parent){
<span class="lineNum">889</span>    if(!parent.hasOwnProperty('children') &amp;&amp; !parent.hasOwnProperty('_children'))
<span class="lineNum">890</span>      parent.children = [];
<span class="lineNum">891</span>
<span class="lineNum">892</span>    if(parent._children)
<span class="lineNum">893</span>      hideChildren(parent);
<span class="lineNum">894</span>    parent.children.push(node);
<span class="lineNum">895</span>
<span class="lineNum">896</span>  }
<span class="lineNum">897</span>  else
<span class="lineNum">898</span>    parent = node;
<span class="lineNum">899</span>
<span class="lineNum">900</span>  update(data);
<span class="lineNum">901</span>
<span class="lineNum">902</span>  forceNodes.push({name: node.name});
<span class="lineNum">903</span>  forceDraw();
<span class="lineNum">904</span>}
<span class="lineNum">905</span>
<span class="lineNum">906</span>function init(){
<span class="lineNum">907</span>
<span class="lineNum">908</span>  document.querySelector("#zoomIn")
<span class="lineNum">909</span>    .addEventListener("click", function(e){
<span class="lineNum">910</span>
<span class="lineNum">911</span>    var svg = document.querySelector("#view")
<span class="lineNum">912</span>      .firstChild
<span class="lineNum">913</span>      .firstChild;
<span class="lineNum">914</span>    var tr = svg.getAttribute("transform");
<span class="lineNum">915</span>
<span class="lineNum">916</span>    if(tr == "translate(60, 0) scale(1)" || tr == "translate(60, 0)")
<span class="lineNum">917</span>      svg
<span class="lineNum">918</span>        .setAttribute("transform", "translate(120, 0) scale(2)");
<span class="lineNum">919</span>    else
<span class="lineNum">920</span>      svg
<span class="lineNum">921</span>        .setAttribute("transform", "translate(60, 0) scale(1)");
<span class="lineNum">922</span>  });
<span class="lineNum">923</span>
<span class="lineNum">924</span>  document.querySelector("#zoomOut")
<span class="lineNum">925</span>    .addEventListener("click", function(e){
<span class="lineNum">926</span>
<span class="lineNum">927</span>    var svg = document.querySelector("#view")
<span class="lineNum">928</span>      .firstChild
<span class="lineNum">929</span>      .firstChild;
<span class="lineNum">930</span>    var tr = svg.getAttribute("transform");
<span class="lineNum">931</span>
<span class="lineNum">932</span>    if(tr == "translate(60, 0) scale(1)" || tr == "translate(60, 0)")
<span class="lineNum">933</span>      svg
<span class="lineNum">934</span>        .setAttribute("transform", "translate(30, 0) scale(.5)");
<span class="lineNum">935</span>    else
<span class="lineNum">936</span>      svg.setAttribute("transform", "translate(60, 0) scale(1)");
<span class="lineNum">937</span>
<span class="lineNum">938</span>  });
<span class="lineNum">939</span>  document.getElementById("fileField").addEventListener("change", function(e){
<span class="lineNum">940</span>    uploadJSON(e);
<span class="lineNum">941</span>  });
<span class="lineNum">942</span>
<span class="lineNum">943</span>  document.getElementById("transcriptField").addEventListener("change", function(e){
<span class="lineNum">944</span>    uploadTranscript(e);
<span class="lineNum">945</span>  });
<span class="lineNum">946</span>
<span class="lineNum">947</span> /* document.getElementById("showTranscript").addEventListener("click", function(e){
<span class="lineNum">948</span>    showTranscript();
<span class="lineNum">949</span>  });
<span class="lineNum">950</span>  */
<span class="lineNum">951</span>  document.getElementById('showTranscript').addEventListener("change", function(e){
<span class="lineNum">952</span>    showTranscript(this.value);
<span class="lineNum">953</span>  });
<span class="lineNum">954</span>
<span class="lineNum">955</span>  document.getElementById('toggleTranscript').addEventListener("click", function(e){
<span class="lineNum">956</span>    document.getElementById('view').classList.toggle('expand');
<span class="lineNum">957</span>    document.getElementById('script').classList.toggle('hidden');
<span class="lineNum">958</span>  });
<span class="lineNum">959</span>  document.getElementById("encodeSelection").addEventListener("click", function(e){
<span class="lineNum">960</span>    encodeSelection();
<span class="lineNum">961</span>  });
<span class="lineNum">962</span>
<span class="lineNum">963</span>  document.getElementById("insertNode").addEventListener("click", function(e){
<span class="lineNum">964</span>    e.preventDefault();
<span class="lineNum">965</span>    var n = document.getElementById("nodeField").value;
<span class="lineNum">966</span>    document.getElementById("nodeField").value = "";
<span class="lineNum">967</span>
<span class="lineNum">968</span>    if(n &amp;&amp; n !== ""){
<span class="lineNum">969</span>      var o = {
<span class="lineNum">970</span>        "name": n,
<span class="lineNum">971</span>        "children": []
<span class="lineNum">972</span>      };
<span class="lineNum">973</span>
<span class="lineNum">974</span>      if(highlighted != null)
<span class="lineNum">975</span>        addNode(d3.select(highlighted).data()[0], o);
<span class="lineNum">976</span>      else
<span class="lineNum">977</span>        addNode(data, o);
<span class="lineNum">978</span>    }
<span class="lineNum">979</span>  });
<span class="lineNum">980</span>  document.getElementById("json").addEventListener("click", function(){
<span class="lineNum">981</span>    var range = document.createRange();
<span class="lineNum">982</span>    range.selectNodeContents(this);
<span class="lineNum">983</span>    var selection = window.getSelection();
<span class="lineNum">984</span>    selection.removeAllRanges();
<span class="lineNum">985</span>    selection.addRange(range);
<span class="lineNum">986</span>  });
<span class="lineNum">987</span>
<span class="lineNum">988</span>  var nodeContext = document.getElementById('nodeContext');
<span class="lineNum">989</span>
<span class="lineNum">990</span>  update();
<span class="lineNum">991</span>};
<span class="lineNum">992</span>
<span class="lineNum">993</span>window.onload = init;
<span class="lineNum">994</span></code></pre></div></div><div class="projects"><div class="projectdesc"><h2 class="projectName">Portfolio Bot</h2><ul class="technology"><li>Node.js</li><li>Bots</li><li>Machine learning</li></ul><ul class="tools"><li>Smooch.io</li><li>Heroku</li><li>Wit.ai</li></ul><p class="projectText">I was working on a bot to answer questions for guests on my portfolio. The bot runs on Smooch and uses a webhook on a Heroku server.</p><p class="projectText">In the future, I'd like to integrate Wit.ai to incorporate some machine learning and make the bot smarter.</p><a class="seeMore btn" href="./portfolioBot/" target="_blank">Try it</a><!--a.bitbucketRepo.btn(href=p.repo target="_blank") See the repo--></div></div><div class="projects"><div class="projectdesc"><h2 class="projectName">Sudoku Solver</h2><ul class="technology"><li>MVC</li></ul><ul class="tools"><li>Angular1</li></ul><p class="projectText">To experiment with Angular.js modules, services, and data-binding, I created a naive, constraint-based sudoku solver.</p><a class="seeMore btn" href="./sudoku/" target="_blank">Try it</a><!--a.bitbucketRepo.btn(href=p.repo target="_blank") See the repo--></div><div class="demoCont"><ul class="demoFiles"><li class="selected">index.html</li><li>app.module.js</li><li>css/styles.css</li></ul><pre><code class="demo"><span class="lineNum">1</span>&lt;!doctype html&gt;
<span class="lineNum">2</span>&lt;html lang="en" ng-app="sudokuSolverApp"&gt;
<span class="lineNum">3</span>&lt;head&gt;
<span class="lineNum">4</span>	&lt;meta charset="ust-8"&gt;
<span class="lineNum">5</span>	&lt;title&gt;Sudoku Solver&lt;/title&gt;
<span class="lineNum">6</span>
<span class="lineNum">7</span>	&lt;script src="js/angular.min.js" type="text/javascript" &gt;&lt;/script&gt;
<span class="lineNum">8</span>	&lt;script src="app/app.module.js" type="text/javascript"&gt;&lt;/script&gt;
<span class="lineNum">9</span>	&lt;script src="app/sudokuPossibility/sudoku-possibility.module.js"&gt;&lt;/script&gt;
<span class="lineNum">10</span>	&lt;script src="app/sudokuPossibility/sudoku-possibility.component.js"&gt;&lt;/script&gt;
<span class="lineNum">11</span>	&lt;script src="app/sudokuSquare/sudoku-square.module.js"&gt;&lt;/script&gt;
<span class="lineNum">12</span>	&lt;script src="app/sudokuSquare/sudoku-square.component.js"&gt;&lt;/script&gt;
<span class="lineNum">13</span>	&lt;script src="app/sudokuNine/sudoku-nine.module.js"&gt;&lt;/script&gt;
<span class="lineNum">14</span>	&lt;script src="app/sudokuNine/sudoku-nine.component.js"&gt;&lt;/script&gt;
<span class="lineNum">15</span>	&lt;script src="app/sudokuGrid/sudoku-grid.module.js"&gt;&lt;/script&gt;
<span class="lineNum">16</span>	&lt;script src="app/sudokuGrid/sudoku-grid.component.js"&gt;&lt;/script&gt;
<span class="lineNum">17</span>
<span class="lineNum">18</span>	&lt;link rel="stylesheet" href="css/styles.css" /&gt;
<span class="lineNum">19</span>&lt;/head&gt;
<span class="lineNum">20</span>&lt;body&gt;
<span class="lineNum">21</span>	&lt;sudoku-grid&gt;&lt;/sudoku-grid&gt;
<span class="lineNum">22</span>&lt;/body&gt;
<span class="lineNum">23</span>&lt;/html&gt;
<span class="lineNum">24</span></code><code class="demo"><span class="lineNum">1</span>// Define the `sudokuSolverApp` module
<span class="lineNum">2</span>angular.module('sudokuSolverApp', ['sudokuGrid', 'sudokuNine', 'sudokuSquare', 'sudokuPossibility'])
<span class="lineNum">3</span>	.factory("GridFactory", function(){
<span class="lineNum">4</span>	
<span class="lineNum">5</span>	//var self = this;
<span class="lineNum">6</span>	var self = {};
<span class="lineNum">7</span>			
<span class="lineNum">8</span>	Square = function(x,y){
<span class="lineNum">9</span>		this.val = null;
<span class="lineNum">10</span>		this.possibilities = [true, true, true, true, true, true, true, true, true];
<span class="lineNum">11</span>		this.x = x;
<span class="lineNum">12</span>		this.y = y;
<span class="lineNum">13</span>		this.idx = x + 9 * y;
<span class="lineNum">14</span>		this.nineIdx = Math.floor(x/3) + 3*Math.floor(y/3);
<span class="lineNum">15</span>		this.autoFilled = false;
<span class="lineNum">16</span>	};
<span class="lineNum">17</span>
<span class="lineNum">18</span>	function addSquare(sq){
<span class="lineNum">19</span>		if(this.squares.length &gt; 8)
<span class="lineNum">20</span>			throw "Too many squares";
<span class="lineNum">21</span>		if(this instanceof Row)
<span class="lineNum">22</span>			sq.row = this;
<span class="lineNum">23</span>		else if(this instanceof Column)
<span class="lineNum">24</span>			sq.column = this;
<span class="lineNum">25</span>		else if(this instanceof Nine)
<span class="lineNum">26</span>			sq.nine = this;
<span class="lineNum">27</span>
<span class="lineNum">28</span>		this.squares.push(sq);
<span class="lineNum">29</span>		return sq;
<span class="lineNum">30</span>	}
<span class="lineNum">31</span>
<span class="lineNum">32</span>	function getSquare(idx){
<span class="lineNum">33</span>		if(idx &gt; 8)
<span class="lineNum">34</span>			throw "Row not that big";
<span class="lineNum">35</span>		return this.squares[idx];
<span class="lineNum">36</span>	}
<span class="lineNum">37</span>
<span class="lineNum">38</span>	function iterate(func){
<span class="lineNum">39</span>		for(var i = 0; i &lt; 9; i++)
<span class="lineNum">40</span>			func.call(this.squares[i]);
<span class="lineNum">41</span>	}
<span class="lineNum">42</span>
<span class="lineNum">43</span>	function testPossibilities(){
<span class="lineNum">44</span>		if(this.val !== null &amp;&amp; this.val !== undefined)
<span class="lineNum">45</span>			return;
<span class="lineNum">46</span>		var count = 0,
<span class="lineNum">47</span>				last = -1;
<span class="lineNum">48</span>		for(var i = 0; i &lt; 9; i++)
<span class="lineNum">49</span>			if(this.possibilities[i]){
<span class="lineNum">50</span>				count++;
<span class="lineNum">51</span>				last = i;
<span class="lineNum">52</span>			}
<span class="lineNum">53</span>		if(count === 1){
<span class="lineNum">54</span>			this.val = last+1;
<span class="lineNum">55</span>			this.autoFilled = true;
<span class="lineNum">56</span>			this.possibilities[last] = false;
<span class="lineNum">57</span>			this.adjustPossibilities();
<span class="lineNum">58</span>		}
<span class="lineNum">59</span>	}
<span class="lineNum">60</span>
<span class="lineNum">61</span>	function testNeighbors(){
<span class="lineNum">62</span>		this.row.iterate(this.testPossibilities);
<span class="lineNum">63</span>		this.column.iterate(this.testPossibilities);
<span class="lineNum">64</span>		this.nine.iterate(this.testPossibilities);
<span class="lineNum">65</span>	}
<span class="lineNum">66</span>
<span class="lineNum">67</span>	function resetNeighbors(){
<span class="lineNum">68</span>		this.row.iterate(this.resetPossibilities);
<span class="lineNum">69</span>		this.column.iterate(this.resetPossibilities);
<span class="lineNum">70</span>		this.nine.iterate(this.resetPossibilities);
<span class="lineNum">71</span>	}
<span class="lineNum">72</span>
<span class="lineNum">73</span>	function adjustPossibilities(){
<span class="lineNum">74</span>		if(this.val === null || this.val === undefined){
<span class="lineNum">75</span>			this.resetPossibilities();
<span class="lineNum">76</span>			this.resetNeighbors();
<span class="lineNum">77</span>		}
<span class="lineNum">78</span>
<span class="lineNum">79</span>		else{
<span class="lineNum">80</span>			this.autofilled = false;
<span class="lineNum">81</span>			var v = this.val-1;
<span class="lineNum">82</span>			for(var i = 0; i &lt; 9; i++){
<span class="lineNum">83</span>				this.row.squares[i].possibilities[v] = false;
<span class="lineNum">84</span>				this.column.squares[i].possibilities[v] = false;
<span class="lineNum">85</span>				this.nine.squares[i].possibilities[v] = false;
<span class="lineNum">86</span>			}
<span class="lineNum">87</span>
<span class="lineNum">88</span>			this.testNeighbors();
<span class="lineNum">89</span>		}
<span class="lineNum">90</span>	}
<span class="lineNum">91</span>
<span class="lineNum">92</span>	function resetPossibilities(){
<span class="lineNum">93</span>		this.autoFilled = false;
<span class="lineNum">94</span>		for(var i = 0; i &lt; 9; i++)
<span class="lineNum">95</span>			this.possibilities[i] = this.val === null;
<span class="lineNum">96</span>
<span class="lineNum">97</span>		if(this.val !== null)
<span class="lineNum">98</span>			this.doubleCheckPossibilities();
<span class="lineNum">99</span>	}
<span class="lineNum">100</span>
<span class="lineNum">101</span>	function doubleCheckPossibilities(){
<span class="lineNum">102</span>		for(var i = 0; i &lt; 9; i++){
<span class="lineNum">103</span>			var v = this.row.squares[i].val;
<span class="lineNum">104</span>			if(v !== null)
<span class="lineNum">105</span>				this.possibilities[v-1] = false;
<span class="lineNum">106</span>
<span class="lineNum">107</span>			v = this.column.squares[i].val;
<span class="lineNum">108</span>			if(v !== null)
<span class="lineNum">109</span>				this.possibilities[v-1] = false;
<span class="lineNum">110</span>
<span class="lineNum">111</span>			v = this.nine.squares[i].val;
<span class="lineNum">112</span>			if(v !== null)
<span class="lineNum">113</span>				this.possibilities[v-1] = false;
<span class="lineNum">114</span>		}
<span class="lineNum">115</span>	}
<span class="lineNum">116</span>
<span class="lineNum">117</span>	Square.prototype.testPossibilities = testPossibilities;
<span class="lineNum">118</span>	Square.prototype.testNeighbors = testNeighbors;
<span class="lineNum">119</span>	Square.prototype.adjustPossibilities = adjustPossibilities;
<span class="lineNum">120</span>	Square.prototype.resetPossibilities = resetPossibilities;
<span class="lineNum">121</span>	Square.prototype.resetNeighbors = resetNeighbors;
<span class="lineNum">122</span>	Square.prototype.doubleCheckPossibilities = doubleCheckPossibilities;
<span class="lineNum">123</span>
<span class="lineNum">124</span>	Group = function(){
<span class="lineNum">125</span>		this.squares = [];
<span class="lineNum">126</span>	};
<span class="lineNum">127</span>	Group.prototype.addSquare = addSquare;
<span class="lineNum">128</span>	Group.prototype.getSquare = getSquare;
<span class="lineNum">129</span>	Group.prototype.iterate = iterate;
<span class="lineNum">130</span>
<span class="lineNum">131</span>	Row = function(y){
<span class="lineNum">132</span>		Group.call(this);
<span class="lineNum">133</span>		this.y = y;
<span class="lineNum">134</span>	};
<span class="lineNum">135</span>	Row.prototype = Object.create(Group.prototype);
<span class="lineNum">136</span>	Row.prototype.constructor = Row;
<span class="lineNum">137</span>
<span class="lineNum">138</span>	Column = function(x){
<span class="lineNum">139</span>		Group.call(this);
<span class="lineNum">140</span>		this.x = x;
<span class="lineNum">141</span>	};
<span class="lineNum">142</span>	Column.prototype = Object.create(Group.prototype);
<span class="lineNum">143</span>	Column.prototype.constructor = Column;
<span class="lineNum">144</span>
<span class="lineNum">145</span>	Nine = function(idx){
<span class="lineNum">146</span>		Group.call(this);
<span class="lineNum">147</span>		this.idx = idx;
<span class="lineNum">148</span>	};
<span class="lineNum">149</span>	Nine.prototype = Object.create(Group.prototype);
<span class="lineNum">150</span>	Nine.prototype.constructor = Nine;
<span class="lineNum">151</span>
<span class="lineNum">152</span>	self.allSquares = [];
<span class="lineNum">153</span>	self.rows = [];
<span class="lineNum">154</span>	self.columns = [];
<span class="lineNum">155</span>	self.nines = [];
<span class="lineNum">156</span>
<span class="lineNum">157</span>	function expandGrid(){
<span class="lineNum">158</span>		for(var i = 0; i &lt; 9; i++){
<span class="lineNum">159</span>			self.columns.push(new Column(i));
<span class="lineNum">160</span>			self.rows.push(new Row(i));
<span class="lineNum">161</span>			self.nines.push(new Nine(i));
<span class="lineNum">162</span>		}
<span class="lineNum">163</span>	}
<span class="lineNum">164</span>
<span class="lineNum">165</span>	function addToGrid(sq){
<span class="lineNum">166</span>		self.rows[sq.y].addSquare(sq);
<span class="lineNum">167</span>		self.columns[sq.x].addSquare(sq);
<span class="lineNum">168</span>		self.nines[sq.nineIdx].addSquare(sq);
<span class="lineNum">169</span>		self.allSquares.push(sq);
<span class="lineNum">170</span>	}
<span class="lineNum">171</span>
<span class="lineNum">172</span>	function instantiateSquares(){
<span class="lineNum">173</span>		for(var i = 0; i &lt; 9; i++)
<span class="lineNum">174</span>			for(var j = 0; j &lt; 9; j++)
<span class="lineNum">175</span>				addToGrid(new Square(j, i));
<span class="lineNum">176</span>	}
<span class="lineNum">177</span>
<span class="lineNum">178</span>	self.getChange = function(square){
<span class="lineNum">179</span>		square.adjustPossibilities();
<span class="lineNum">180</span>	};
<span class="lineNum">181</span>
<span class="lineNum">182</span>	expandGrid();
<span class="lineNum">183</span>	instantiateSquares();
<span class="lineNum">184</span>	
<span class="lineNum">185</span>	return self;
<span class="lineNum">186</span>	
<span class="lineNum">187</span>});
<span class="lineNum">188</span></code><code class="demo"><span class="lineNum">1</span>
<span class="lineNum">2</span>sudoku-grid {
<span class="lineNum">3</span>  font-size: 0;
<span class="lineNum">4</span>}
<span class="lineNum">5</span>
<span class="lineNum">6</span>sudoku-nine {
<span class="lineNum">7</span>  display: inline-block;
<span class="lineNum">8</span>  width: 33.3%;
<span class="lineNum">9</span>  width: calc(100% / 3);
<span class="lineNum">10</span>  height: 0;
<span class="lineNum">11</span>  padding-bottom: 33.3%;
<span class="lineNum">12</span>  padding-bottom: calc(100% / 3 - 2px);
<span class="lineNum">13</span>  font-size: 0;
<span class="lineNum">14</span>  border: 2px solid black;
<span class="lineNum">15</span>  box-sizing: border-box;
<span class="lineNum">16</span>}
<span class="lineNum">17</span>
<span class="lineNum">18</span>sudoku-square {
<span class="lineNum">19</span>  display: inline-block;
<span class="lineNum">20</span>  width: 33.3%;
<span class="lineNum">21</span>  width: calc((100% - 2px) / 3);
<span class="lineNum">22</span>  width: calc(100% / 3);
<span class="lineNum">23</span>  height: 0;
<span class="lineNum">24</span>  padding-bottom: 33.3%;
<span class="lineNum">25</span>  padding-bottom: calc(100% / 3 - 2px);
<span class="lineNum">26</span>  border: 1px solid black;
<span class="lineNum">27</span>  box-sizing: border-box;
<span class="lineNum">28</span>  position: relative;
<span class="lineNum">29</span>  font-size: 0;
<span class="lineNum">30</span>}
<span class="lineNum">31</span>
<span class="lineNum">32</span>sudoku-square input {
<span class="lineNum">33</span>  font-size: 18pt;
<span class="lineNum">34</span>  line-height: 0;
<span class="lineNum">35</span>  width: 100%;
<span class="lineNum">36</span>  height: 0;
<span class="lineNum">37</span>  padding: 50% 0;
<span class="lineNum">38</span>  box-sizing: border-box;
<span class="lineNum">39</span>  border: none;
<span class="lineNum">40</span>  position: absolute;
<span class="lineNum">41</span>  top: 0;
<span class="lineNum">42</span>  left: 0;
<span class="lineNum">43</span>  text-align: center;
<span class="lineNum">44</span>  z-index: 0;
<span class="lineNum">45</span>}
<span class="lineNum">46</span>
<span class="lineNum">47</span>sudoku-square.autoFilled input {
<span class="lineNum">48</span>  color: blue;
<span class="lineNum">49</span>}
<span class="lineNum">50</span>
<span class="lineNum">51</span>sudoku-square input:focus ~ sudoku-possibility {
<span class="lineNum">52</span>  opacity: 0;
<span class="lineNum">53</span>}
<span class="lineNum">54</span>
<span class="lineNum">55</span>sudoku-possibility {
<span class="lineNum">56</span>  display: inline-block;
<span class="lineNum">57</span>  width: inherit;
<span class="lineNum">58</span>  height: inherit;
<span class="lineNum">59</span>  padding: 16.66% 0;
<span class="lineNum">60</span>  padding: calc(100% / 6) 0;
<span class="lineNum">61</span>  position: absolute;
<span class="lineNum">62</span>  font-size: 12pt;
<span class="lineNum">63</span>  line-height: 0;
<span class="lineNum">64</span>  text-align: center;
<span class="lineNum">65</span>  color: blue;
<span class="lineNum">66</span>  opacity: 0;
<span class="lineNum">67</span>  pointer-events: none;
<span class="lineNum">68</span>}
<span class="lineNum">69</span>
<span class="lineNum">70</span>sudoku-possibility.possible {
<span class="lineNum">71</span>  opacity: .5
<span class="lineNum">72</span>}
<span class="lineNum">73</span>
<span class="lineNum">74</span>sudoku-possibility:nth-of-type(3n+1){ left: 0; }
<span class="lineNum">75</span>sudoku-possibility:nth-of-type(3n+2){ left: 33.33%; }
<span class="lineNum">76</span>sudoku-possibility:nth-of-type(3n){ left: 66.66%; }
<span class="lineNum">77</span>sudoku-possibility:nth-of-type(-n+3){ top: 0; }
<span class="lineNum">78</span>sudoku-possibility:nth-of-type(n+4){ top: 33.33%; }
<span class="lineNum">79</span>sudoku-possibility:nth-of-type(n+7){ top: 66.66% }
<span class="lineNum">80</span></code></pre></div></div><div class="projects"><div class="projectdesc"><h2 class="projectName">Picross Solver</h2><ul class="technology"><li>MVC</li><li>Typescript</li></ul><ul class="tools"><li>Angular2</li></ul><p class="projectText">To familiarize myself with Angular2 and Typescript, I started on a web app to solve nonograms.</p><a class="seeMore btn" href="./picross/" target="_blank">Try it</a><!--a.bitbucketRepo.btn(href=p.repo target="_blank") See the repo--></div><div class="demoCont"><ul class="demoFiles"><li class="selected">app.component.ts</li><li>grid.service.ts</li><li>line.ts</li><li>square.ts</li><li>hint.ts</li></ul><pre><code class="demo"><span class="lineNum">1</span>import { Component, OnInit }  from '@angular/core';
<span class="lineNum">2</span>
<span class="lineNum">3</span>import { Square }             from './square';
<span class="lineNum">4</span>import { Line }               from './line';
<span class="lineNum">5</span>import { GridService }        from './grid.service';
<span class="lineNum">6</span>
<span class="lineNum">7</span>@Component({
<span class="lineNum">8</span>  selector: 'my-app',
<span class="lineNum">9</span>  template: `
<span class="lineNum">10</span>  &lt;h1&gt;Hello {{name}}&lt;/h1&gt;
<span class="lineNum">11</span>  &lt;input type="number" [(ngModel)]="width" /&gt;
<span class="lineNum">12</span>  &lt;input type="number" [(ngModel)]="height" /&gt;
<span class="lineNum">13</span>  &lt;input type="button" (click)="getGrid()" value="Set Size"/&gt;
<span class="lineNum">14</span>  &lt;div *ngFor="let r of rows"&gt;
<span class="lineNum">15</span>    &lt;line-hints [hints]=r.hints [max]="width"&gt;&lt;/line-hints&gt;
<span class="lineNum">16</span>    &lt;picross-square *ngFor="let sq of r.squares" [square]=sq&gt;&lt;/picross-square&gt;
<span class="lineNum">17</span>  &lt;/div&gt;
<span class="lineNum">18</span>  `,
<span class="lineNum">19</span>  providers: [ GridService ]
<span class="lineNum">20</span>})
<span class="lineNum">21</span>export class AppComponent implements OnInit {
<span class="lineNum">22</span>  name = 'Angular';
<span class="lineNum">23</span>  squares: Square[];
<span class="lineNum">24</span>  rows: Line[];
<span class="lineNum">25</span>  width: number = 5;
<span class="lineNum">26</span>  height: number = 5;
<span class="lineNum">27</span>
<span class="lineNum">28</span>  constructor(private gridService: GridService) {}
<span class="lineNum">29</span>
<span class="lineNum">30</span>  getGrid(): void {
<span class="lineNum">31</span>    this.gridService.setSize(this.width, this.height)
<span class="lineNum">32</span>      .then(() =&gt; this.gridService.getGrid())
<span class="lineNum">33</span>      .then(squares =&gt; this.squares = squares)
<span class="lineNum">34</span>      .then(() =&gt; this.gridService.getRows())
<span class="lineNum">35</span>      .then(rows =&gt; this.rows = rows);
<span class="lineNum">36</span>  }
<span class="lineNum">37</span>
<span class="lineNum">38</span>  ngOnInit(): void {
<span class="lineNum">39</span>    this.getGrid();
<span class="lineNum">40</span>  }
<span class="lineNum">41</span>}
<span class="lineNum">42</span></code><code class="demo"><span class="lineNum">1</span>import { Injectable } from '@angular/core';
<span class="lineNum">2</span>
<span class="lineNum">3</span>
<span class="lineNum">4</span>import { Square }     from './square';
<span class="lineNum">5</span>import { Line }       from './line';
<span class="lineNum">6</span>
<span class="lineNum">7</span>@Injectable()
<span class="lineNum">8</span>export class GridService {
<span class="lineNum">9</span>  private squares: Square[] = [];
<span class="lineNum">10</span>  private rows: Line[] = [];
<span class="lineNum">11</span>  private columns: Line[] = [];
<span class="lineNum">12</span>
<span class="lineNum">13</span>  setSize(w: number, h: number): Promise&lt;void&gt; {
<span class="lineNum">14</span>
<span class="lineNum">15</span>    while (this.squares.length) {
<span class="lineNum">16</span>      this.squares.pop();
<span class="lineNum">17</span>    }
<span class="lineNum">18</span>
<span class="lineNum">19</span>    while (this.rows.length) {
<span class="lineNum">20</span>      this.rows.pop();
<span class="lineNum">21</span>    }
<span class="lineNum">22</span>
<span class="lineNum">23</span>    while (this.columns.length) {
<span class="lineNum">24</span>      this.columns.pop();
<span class="lineNum">25</span>    }
<span class="lineNum">26</span>
<span class="lineNum">27</span>    for (let i = 0; i &lt; h; i++) {
<span class="lineNum">28</span>      let r: Line = new Line();
<span class="lineNum">29</span>      this.rows.push(r);
<span class="lineNum">30</span>    }
<span class="lineNum">31</span>
<span class="lineNum">32</span>    for (let i = 0; i &lt; w; i++) {
<span class="lineNum">33</span>      let c: Line = new Line();
<span class="lineNum">34</span>      this.columns.push(c);
<span class="lineNum">35</span>    }
<span class="lineNum">36</span>
<span class="lineNum">37</span>    for (let i = 0; i &lt; h; i++) {
<span class="lineNum">38</span>      for (let j = 0; j &lt; w; j++) {
<span class="lineNum">39</span>        let s: Square = new Square('sq' + (i * w + j));
<span class="lineNum">40</span>        this.squares.push(s);
<span class="lineNum">41</span>        this.rows[i].pushSquare(s);
<span class="lineNum">42</span>        this.columns[j].pushSquare(s);
<span class="lineNum">43</span>      }
<span class="lineNum">44</span>    }
<span class="lineNum">45</span>
<span class="lineNum">46</span>    return Promise.resolve();
<span class="lineNum">47</span>  }
<span class="lineNum">48</span>
<span class="lineNum">49</span>  getGrid(): Promise&lt;Square[]&gt; {
<span class="lineNum">50</span>    return Promise.resolve(this.squares);
<span class="lineNum">51</span>  }
<span class="lineNum">52</span>
<span class="lineNum">53</span>  getRows(): Promise&lt;Line[]&gt; {
<span class="lineNum">54</span>    return Promise.resolve(this.rows);
<span class="lineNum">55</span>  }
<span class="lineNum">56</span>
<span class="lineNum">57</span>  getSquare(idx: number): Promise&lt;Square&gt; {
<span class="lineNum">58</span>    return Promise.resolve(this.squares[idx]);
<span class="lineNum">59</span>  }
<span class="lineNum">60</span>}
<span class="lineNum">61</span></code><code class="demo"><span class="lineNum">1</span>import { Square } from './square';
<span class="lineNum">2</span>import { Hint }   from './hint';
<span class="lineNum">3</span>
<span class="lineNum">4</span>export class Line {
<span class="lineNum">5</span>  squares: Square[] = [];
<span class="lineNum">6</span>  hints: Hint[] = [];
<span class="lineNum">7</span>  sections: Line[] = [];
<span class="lineNum">8</span>
<span class="lineNum">9</span>  constructor() {
<span class="lineNum">10</span>  }
<span class="lineNum">11</span>  pushSquare(sq: Square): void {
<span class="lineNum">12</span>    this.squares.push(sq);
<span class="lineNum">13</span>  }
<span class="lineNum">14</span>  findSections(): void {
<span class="lineNum">15</span>    for (let s = 0, e = 0; e &lt; this.squares.length; e++) {
<span class="lineNum">16</span>      if (this.squares[e].state === Square.CROSSED) {
<span class="lineNum">17</span>        this.tryFindSection(s, e);
<span class="lineNum">18</span>        s = e;
<span class="lineNum">19</span>      }
<span class="lineNum">20</span>    }
<span class="lineNum">21</span>  }
<span class="lineNum">22</span>  tryFindSection(s: number, e: number): void {
<span class="lineNum">23</span>    if (e - s &gt; 1) {
<span class="lineNum">24</span>      let l = new Line();
<span class="lineNum">25</span>      for (; s &lt; e; s++) {
<span class="lineNum">26</span>        l.pushSquare(this.squares[s]);
<span class="lineNum">27</span>      }
<span class="lineNum">28</span>      this.sections.push(l);
<span class="lineNum">29</span>    }
<span class="lineNum">30</span>  }
<span class="lineNum">31</span>}
<span class="lineNum">32</span></code><code class="demo"><span class="lineNum">1</span>export class Square {
<span class="lineNum">2</span>  static readonly EMPTY = 0;
<span class="lineNum">3</span>  static readonly FILLED = 1;
<span class="lineNum">4</span>  static readonly CROSSED = 2;
<span class="lineNum">5</span>  id: string;
<span class="lineNum">6</span>  state: number;
<span class="lineNum">7</span>
<span class="lineNum">8</span>  constructor(id: string) {
<span class="lineNum">9</span>    this.id = id;
<span class="lineNum">10</span>    this.state = Square.EMPTY;
<span class="lineNum">11</span>  }
<span class="lineNum">12</span>  fill(): void { this.state = Square.FILLED; }
<span class="lineNum">13</span>  cross(): void { this.state = Square.CROSSED; }
<span class="lineNum">14</span>  clear(): void { this.state = Square.EMPTY; }
<span class="lineNum">15</span>}
<span class="lineNum">16</span></code><code class="demo"><span class="lineNum">1</span>export class Hint {
<span class="lineNum">2</span>  num: number;
<span class="lineNum">3</span>  completed: boolean;
<span class="lineNum">4</span>}
<span class="lineNum">5</span></code></pre></div></div></div></div><div class="footer"><form class="fs-4 fs-5-800 fs-8-640 fo-1 fo-1280 fo-1-800" id="contact" method="post" action="email.php" onsubmit="AJAXReq(this); return false;"><h3 id="contact_me">Contact Me</h3><input id="guestname" name="guestname" placeholder="What's your name?" required="required" type="text"><label class="namelabel" for="guestname">Name</label><input id="guestemail" name="guestemail" placeholder="And your email?" required="required" type="email"><label class="emaillabel" for="guestemail">Email</label><textarea id="guestmessage" name="guestmessage" required="required" placeholder="What can I help you with?"></textarea><label class="messagelabel" for="guestmessage">Message</label><label class="feedback"></label><input class="submit" type="submit" value="Send"></form><p id="copyright">&copy; 2017 by Chris Gaeta</p></div></div></body></html>